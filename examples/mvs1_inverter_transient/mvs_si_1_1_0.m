function MOD = mvs_si_1_1_0(uniqID)

%===============================================================================
% This file was created using VAPP, the Berkeley Verilog-A Parser and Processor.   
% Last modified: 23-Feb-2017 13:31:27
% VAPP version: master:22070d7
%===============================================================================

    MOD = ModSpec_common_skeleton();

    MOD.parm_types = {};
    MOD.u_names = {};
    MOD.IO_names = {};
    MOD.OtherIO_names = {};
    MOD.NIL.io_types = {};
    MOD.NIL.io_nodenames = {};
    MOD.limited_var_names = {};
    MOD.vecXY_to_limitedvars_matrix = [];
    MOD.uniqID = [];

    MOD.support_initlimiting = 1;

    if nargin > 0
        MOD.uniqID = uniqID;
    end

    MOD.model_name = 'mvs_si_1_1_0';
    MOD.NIL.node_names = {'d', 'g', 's', 'b'};
    MOD.NIL.refnode_name = 'b';

    parmNameDefValArr = {'parm_version', 1.1,...
                         'parm_type', 1,...
                         'parm_W', 0.0001,...
                         'parm_Lgdr', 8e-06,...
                         'parm_dLg', 1.05e-06,...
                         'parm_Cg', 2.2e-06,...
                         'parm_etov', 0.0013,...
                         'parm_delta', 0.1,...
                         'parm_n0', 1.5,...
                         'parm_Rs0', 100,...
                         'parm_Rd0', 100,...
                         'parm_Cif', 1e-12,...
                         'parm_Cof', 2e-13,...
                         'parm_vxo', 7650000,...
                         'parm_mu', 200,...
                         'parm_beta', 1.7,...
                         'parm_Tjun', 298,...
                         'parm_phib', 1.2,...
                         'parm_gamma', 0,...
                         'parm_Vt0', 0.486,...
                         'parm_alpha', 3.5,...
                         'parm_mc', 0.2,...
                         'parm_CTM_select', 1,...
                         'parm_CC', 0,...
                         'parm_nd', 0,...
                         'parm_zeta', 1};

    nParm = 26;
    MOD.parm_names = {};
    MOD.parm_defaultvals = {};
    MOD.parm_vals = {};
    MOD.parm_given_flag = zeros(1, nParm);
    for parmIdx = 1:nParm
        MOD.parm_names{parmIdx} = parmNameDefValArr{2*parmIdx-1};
        MOD.parm_defaultvals{parmIdx} = parmNameDefValArr{2*parmIdx};
        MOD.parm_vals{parmIdx} = parmNameDefValArr{2*parmIdx};
    end

    [eonames, iunames, ienames] = get_oui_names__(MOD);
    MOD.explicit_output_names = eonames;
    MOD.internal_unk_names = iunames;
    MOD.implicit_equation_names = ienames;
    MOD.InternalUnkNames = @get_iu_names__;
    MOD.ImplicitEquationNames = @get_ie_names__;

    MOD = setup_IOnames_OtherIOnames_IOtypes_IOnodenames(MOD);

    MOD.fqeiJ = @fqeiJ;
    MOD.fe = @fe_from_fqeiJ_ModSpec;
    MOD.qe = @qe_from_fqeiJ_ModSpec;
    MOD.fi = @fi_from_fqeiJ_ModSpec;
    MOD.qi = @qi_from_fqeiJ_ModSpec;
    MOD.fqei = @fqei_from_fqeiJ_ModSpec;
    MOD.fqeiJ = @fqeiJ;

    MOD.dfe_dvecX = @dfe_dvecX_from_fqeiJ_ModSpec;
    MOD.dfe_dvecY = @dfe_dvecY_from_fqeiJ_ModSpec;
    MOD.dfe_dvecLim = @dfe_dvecLim_from_fqeiJ_ModSpec;
    MOD.dfe_dvecU = @dfe_dvecU_from_fqeiJ_ModSpec;

    MOD.dqe_dvecX = @dqe_dvecX_from_fqeiJ_ModSpec;
    MOD.dqe_dvecY = @dqe_dvecY_from_fqeiJ_ModSpec;
    MOD.dqe_dvecLim = @dqe_dvecLim_from_fqeiJ_ModSpec;

    MOD.dfi_dvecX = @dfi_dvecX_from_fqeiJ_ModSpec;
    MOD.dfi_dvecY = @dfi_dvecY_from_fqeiJ_ModSpec;
    MOD.dfi_dvecLim = @dfi_dvecLim_from_fqeiJ_ModSpec;
    MOD.dfi_dvecU = @dfi_dvecU_from_fqeiJ_ModSpec;

    MOD.dqi_dvecX = @dqi_dvecX_from_fqeiJ_ModSpec;
    MOD.dqi_dvecY = @dqi_dvecY_from_fqeiJ_ModSpec;
    MOD.dqi_dvecLim = @dqi_dvecLim_from_fqeiJ_ModSpec;
end

function [fqei_out, J_out] = fqeiJ(vecX, vecY, vecLim, vecU, flag, MOD)
    if nargin < 6
        MOD = flag;
        flag = vecU;
        vecU = vecLim;
    end

    [fe, qe, fi, qi, d_fe_d_X, d_qe_d_X, d_fi_d_X, d_qi_d_X,...
    d_fe_d_Y, d_qe_d_Y, d_fi_d_Y, d_qi_d_Y] = fqei_dfqeidXYU(vecX, vecY, MOD);

    fqei_out.fe = fe;
    fqei_out.qe = qe;
    fqei_out.fi = fi;
    fqei_out.qi = qi;

    [nFeQe, nFiQi] = get_nfq__(MOD);

    J_out.Jfe.dfe_dvecX = d_fe_d_X;
    J_out.Jqe.dqe_dvecX = d_qe_d_X;
    J_out.Jfi.dfi_dvecX = d_fi_d_X;
    J_out.Jqi.dqi_dvecX = d_qi_d_X;
    J_out.Jfe.dfe_dvecY = d_fe_d_Y;
    J_out.Jqe.dqe_dvecY = d_qe_d_Y;
    J_out.Jfi.dfi_dvecY = d_fi_d_Y;
    J_out.Jqi.dqi_dvecY = d_qi_d_Y;
    J_out.Jfe.dfe_dvecU = zeros(nFeQe,0);
    J_out.Jfi.dfi_dvecU = zeros(nFiQi,0);
    J_out.Jfe.dfe_dvecLim = zeros(nFeQe, 0);
    J_out.Jqe.dqe_dvecLim = zeros(nFeQe, 0);
    J_out.Jfi.dfi_dvecLim = zeros(nFiQi, 0);
    J_out.Jqi.dqi_dvecLim = zeros(nFiQi, 0);
end

function [fe__, qe__, fi__, qi__,...
          d_fe_d_X__, d_qe_d_X__, d_fi_d_X__, d_qi_d_X__,...
          d_fe_d_Y__, d_qe_d_Y__, d_fi_d_Y__, d_qi_d_Y__] = ...
         fqei_dfqeidXYU(vecX__, vecY__, MOD__)

    % initializing parameters
    parm_version = MOD__.parm_vals{1};
    parm_type = MOD__.parm_vals{2};
    parm_W = MOD__.parm_vals{3};
    parm_Lgdr = MOD__.parm_vals{4};
    parm_dLg = MOD__.parm_vals{5};
    parm_Cg = MOD__.parm_vals{6};
    parm_etov = MOD__.parm_vals{7};
    parm_delta = MOD__.parm_vals{8};
    parm_n0 = MOD__.parm_vals{9};
    parm_Rs0 = MOD__.parm_vals{10};
    parm_Rd0 = MOD__.parm_vals{11};
    parm_Cif = MOD__.parm_vals{12};
    parm_Cof = MOD__.parm_vals{13};
    parm_vxo = MOD__.parm_vals{14};
    parm_mu = MOD__.parm_vals{15};
    parm_beta = MOD__.parm_vals{16};
    parm_Tjun = MOD__.parm_vals{17};
    parm_phib = MOD__.parm_vals{18};
    parm_gamma = MOD__.parm_vals{19};
    parm_Vt0 = MOD__.parm_vals{20};
    parm_alpha = MOD__.parm_vals{21};
    parm_mc = MOD__.parm_vals{22};
    parm_CTM_select = MOD__.parm_vals{23};
    parm_CC = MOD__.parm_vals{24};
    parm_nd = MOD__.parm_vals{25};
    parm_zeta = MOD__.parm_vals{26};

    [nFeQe__, nFiQi__, nOtherIo__, nIntUnk__] = get_nfq__(MOD__);

    % Initializing outputs
    fe__ = zeros(nFeQe__,1);
    qe__ = zeros(nFeQe__,1);
    fi__ = zeros(nFiQi__,1);
    qi__ = zeros(nFiQi__,1);
    % Initializing derivatives
    d_fe_d_X__ = zeros(nFeQe__,nOtherIo__);
    d_qe_d_X__ = zeros(nFeQe__,nOtherIo__);
    d_fi_d_X__ = zeros(nFiQi__,nOtherIo__);
    d_qi_d_X__ = zeros(nFiQi__,nOtherIo__);
    d_fe_d_Y__ = zeros(nFeQe__,nIntUnk__);
    d_qe_d_Y__ = zeros(nFeQe__,nIntUnk__);
    d_fi_d_Y__ = zeros(nFiQi__,nIntUnk__);
    d_qi_d_Y__ = zeros(nFiQi__,nIntUnk__);
    % initializing variables
    d_A_d_v_bsi__ = 0;
    d_A_d_v_db__ = 0;
    d_A_d_v_disi__ = 0;
    d_A_d_v_gb__ = 0;
    d_A_d_v_sb__ = 0;
    d_B_d_v_bsi__ = 0;
    d_B_d_v_db__ = 0;
    d_B_d_v_disi__ = 0;
    d_B_d_v_gb__ = 0;
    d_B_d_v_sb__ = 0;
    d_FF0_d_v_bsi__ = 0;
    d_FF0_d_v_disi__ = 0;
    d_FF0_d_v_gb__ = 0;
    d_FF_d_v_bsi__ = 0;
    d_FF_d_v_db__ = 0;
    d_FF_d_v_disi__ = 0;
    d_FF_d_v_gb__ = 0;
    d_FF_d_v_sb__ = 0;
    d_FFpre_d_v_bsi__ = 0;
    d_FFpre_d_v_db__ = 0;
    d_FFpre_d_v_disi__ = 0;
    d_FFpre_d_v_gb__ = 0;
    d_FFpre_d_v_sb__ = 0;
    d_FFx_d_v_bsi__ = 0;
    d_FFx_d_v_db__ = 0;
    d_FFx_d_v_disi__ = 0;
    d_FFx_d_v_gb__ = 0;
    d_FFx_d_v_sb__ = 0;
    d_FFy_d_v_bsi__ = 0;
    d_FFy_d_v_db__ = 0;
    d_FFy_d_v_disi__ = 0;
    d_FFy_d_v_gb__ = 0;
    d_FFy_d_v_sb__ = 0;
    d_Fd_arg_d_v_bsi__ = 0;
    d_Fd_arg_d_v_db__ = 0;
    d_Fd_arg_d_v_disi__ = 0;
    d_Fd_arg_d_v_gb__ = 0;
    d_Fd_arg_d_v_sb__ = 0;
    d_Fd_d_v_bsi__ = 0;
    d_Fd_d_v_db__ = 0;
    d_Fd_d_v_disi__ = 0;
    d_Fd_d_v_gb__ = 0;
    d_Fd_d_v_sb__ = 0;
    d_Fs_arg_d_v_bsi__ = 0;
    d_Fs_arg_d_v_db__ = 0;
    d_Fs_arg_d_v_disi__ = 0;
    d_Fs_arg_d_v_gb__ = 0;
    d_Fs_arg_d_v_sb__ = 0;
    d_Fs_d_v_bsi__ = 0;
    d_Fs_d_v_db__ = 0;
    d_Fs_d_v_disi__ = 0;
    d_Fs_d_v_gb__ = 0;
    d_Fs_d_v_sb__ = 0;
    d_Fsat_d_v_bsi__ = 0;
    d_Fsat_d_v_db__ = 0;
    d_Fsat_d_v_disi__ = 0;
    d_Fsat_d_v_gb__ = 0;
    d_Fsat_d_v_sb__ = 0;
    d_Fsatq_d_v_bsi__ = 0;
    d_Fsatq_d_v_db__ = 0;
    d_Fsatq_d_v_disi__ = 0;
    d_Fsatq_d_v_gb__ = 0;
    d_Fsatq_d_v_sb__ = 0;
    d_Id_d_v_bsi__ = 0;
    d_Id_d_v_db__ = 0;
    d_Id_d_v_disi__ = 0;
    d_Id_d_v_gb__ = 0;
    d_Id_d_v_sb__ = 0;
    d_Qb_d_v_bsi__ = 0;
    d_Qb_d_v_db__ = 0;
    d_Qb_d_v_disi__ = 0;
    d_Qb_d_v_gb__ = 0;
    d_Qb_d_v_sb__ = 0;
    d_Qd_d_v_bsi__ = 0;
    d_Qd_d_v_db__ = 0;
    d_Qd_d_v_disi__ = 0;
    d_Qd_d_v_gb__ = 0;
    d_Qd_d_v_sb__ = 0;
    d_Qdif_d_v_bsi__ = 0;
    d_Qdif_d_v_db__ = 0;
    d_Qdif_d_v_disi__ = 0;
    d_Qdif_d_v_gb__ = 0;
    d_Qdif_d_v_sb__ = 0;
    d_Qdov_d_v_bsi__ = 0;
    d_Qdov_d_v_disi__ = 0;
    d_Qdov_d_v_gb__ = 0;
    d_Qg_d_v_bsi__ = 0;
    d_Qg_d_v_db__ = 0;
    d_Qg_d_v_disi__ = 0;
    d_Qg_d_v_gb__ = 0;
    d_Qg_d_v_sb__ = 0;
    d_Qinv_corr_d_v_bsi__ = 0;
    d_Qinv_corr_d_v_db__ = 0;
    d_Qinv_corr_d_v_disi__ = 0;
    d_Qinv_corr_d_v_gb__ = 0;
    d_Qinv_corr_d_v_sb__ = 0;
    d_Qinv_d_v_bsi__ = 0;
    d_Qinv_d_v_db__ = 0;
    d_Qinv_d_v_disi__ = 0;
    d_Qinv_d_v_gb__ = 0;
    d_Qinv_d_v_sb__ = 0;
    d_Qinvd_d_v_bsi__ = 0;
    d_Qinvd_d_v_db__ = 0;
    d_Qinvd_d_v_disi__ = 0;
    d_Qinvd_d_v_gb__ = 0;
    d_Qinvd_d_v_sb__ = 0;
    d_Qinvi_d_v_bsi__ = 0;
    d_Qinvi_d_v_db__ = 0;
    d_Qinvi_d_v_disi__ = 0;
    d_Qinvi_d_v_gb__ = 0;
    d_Qinvi_d_v_sb__ = 0;
    d_Qinvs_d_v_bsi__ = 0;
    d_Qinvs_d_v_db__ = 0;
    d_Qinvs_d_v_disi__ = 0;
    d_Qinvs_d_v_gb__ = 0;
    d_Qinvs_d_v_sb__ = 0;
    d_Qref_d_v_bsi__ = 0;
    d_Qref_d_v_disi__ = 0;
    d_Qref_d_v_gb__ = 0;
    d_Qs_d_v_bsi__ = 0;
    d_Qs_d_v_db__ = 0;
    d_Qs_d_v_disi__ = 0;
    d_Qs_d_v_gb__ = 0;
    d_Qs_d_v_sb__ = 0;
    d_Qsif_d_v_bsi__ = 0;
    d_Qsif_d_v_db__ = 0;
    d_Qsif_d_v_disi__ = 0;
    d_Qsif_d_v_gb__ = 0;
    d_Qsif_d_v_sb__ = 0;
    d_Qsov_d_v_bsi__ = 0;
    d_Qsov_d_v_gb__ = 0;
    d_Vbs_d_v_bsi__ = 0;
    d_Vbs_d_v_db__ = 0;
    d_Vbs_d_v_disi__ = 0;
    d_Vbs_d_v_gb__ = 0;
    d_Vbs_d_v_sb__ = 0;
    d_Vbscorr_d_v_bsi__ = 0;
    d_Vbscorr_d_v_db__ = 0;
    d_Vbscorr_d_v_disi__ = 0;
    d_Vbscorr_d_v_gb__ = 0;
    d_Vbscorr_d_v_sb__ = 0;
    d_Vbsi_d_v_bsi__ = 0;
    d_Vbsi_d_v_disi__ = 0;
    d_Vbsi_d_v_gb__ = 0;
    d_Vcorr_d_v_bsi__ = 0;
    d_Vcorr_d_v_db__ = 0;
    d_Vcorr_d_v_disi__ = 0;
    d_Vcorr_d_v_gb__ = 0;
    d_Vcorr_d_v_sb__ = 0;
    d_Vdbeta_d_v_bsi__ = 0;
    d_Vdbeta_d_v_db__ = 0;
    d_Vdbeta_d_v_disi__ = 0;
    d_Vdbeta_d_v_gb__ = 0;
    d_Vdbeta_d_v_sb__ = 0;
    d_Vdbetabeta_d_v_bsi__ = 0;
    d_Vdbetabeta_d_v_db__ = 0;
    d_Vdbetabeta_d_v_disi__ = 0;
    d_Vdbetabeta_d_v_gb__ = 0;
    d_Vdbetabeta_d_v_sb__ = 0;
    d_Vdratio_d_v_bsi__ = 0;
    d_Vdratio_d_v_db__ = 0;
    d_Vdratio_d_v_disi__ = 0;
    d_Vdratio_d_v_gb__ = 0;
    d_Vdratio_d_v_sb__ = 0;
    d_Vds_d_v_bsi__ = 0;
    d_Vds_d_v_db__ = 0;
    d_Vds_d_v_disi__ = 0;
    d_Vds_d_v_gb__ = 0;
    d_Vds_d_v_sb__ = 0;
    d_Vdsat_d_v_bsi__ = 0;
    d_Vdsat_d_v_db__ = 0;
    d_Vdsat_d_v_disi__ = 0;
    d_Vdsat_d_v_gb__ = 0;
    d_Vdsat_d_v_sb__ = 0;
    d_Vdsatq_d_v_bsi__ = 0;
    d_Vdsatq_d_v_db__ = 0;
    d_Vdsatq_d_v_disi__ = 0;
    d_Vdsatq_d_v_gb__ = 0;
    d_Vdsatq_d_v_sb__ = 0;
    d_Vdsi_d_v_bsi__ = 0;
    d_Vdsi_d_v_disi__ = 0;
    d_Vdsi_d_v_gb__ = 0;
    d_Vgdraw_d_v_bsi__ = 0;
    d_Vgdraw_d_v_disi__ = 0;
    d_Vgdraw_d_v_gb__ = 0;
    d_Vgs_d_v_bsi__ = 0;
    d_Vgs_d_v_db__ = 0;
    d_Vgs_d_v_disi__ = 0;
    d_Vgs_d_v_gb__ = 0;
    d_Vgs_d_v_sb__ = 0;
    d_Vgscorr_d_v_bsi__ = 0;
    d_Vgscorr_d_v_db__ = 0;
    d_Vgscorr_d_v_disi__ = 0;
    d_Vgscorr_d_v_gb__ = 0;
    d_Vgscorr_d_v_sb__ = 0;
    d_Vgsi_d_v_bsi__ = 0;
    d_Vgsi_d_v_disi__ = 0;
    d_Vgsi_d_v_gb__ = 0;
    d_Vgsraw_d_v_bsi__ = 0;
    d_Vgsraw_d_v_gb__ = 0;
    d_Vgt_d_v_bsi__ = 0;
    d_Vgt_d_v_db__ = 0;
    d_Vgt_d_v_disi__ = 0;
    d_Vgt_d_v_gb__ = 0;
    d_Vgt_d_v_sb__ = 0;
    d_Vgta_d_v_bsi__ = 0;
    d_Vgta_d_v_db__ = 0;
    d_Vgta_d_v_disi__ = 0;
    d_Vgta_d_v_gb__ = 0;
    d_Vgta_d_v_sb__ = 0;
    d_Vt0bs0_d_v_bsi__ = 0;
    d_Vt0bs0_d_v_disi__ = 0;
    d_Vt0bs0_d_v_gb__ = 0;
    d_Vt0bs_d_v_bsi__ = 0;
    d_Vt0bs_d_v_db__ = 0;
    d_Vt0bs_d_v_disi__ = 0;
    d_Vt0bs_d_v_gb__ = 0;
    d_Vt0bs_d_v_sb__ = 0;
    d_Vt0x_d_v_bsi__ = 0;
    d_Vt0y_d_v_bsi__ = 0;
    d_Vt0y_d_v_disi__ = 0;
    d_Vtp0_d_v_bsi__ = 0;
    d_Vtp0_d_v_disi__ = 0;
    d_Vtp0_d_v_gb__ = 0;
    d_Vtp_d_v_bsi__ = 0;
    d_Vtp_d_v_db__ = 0;
    d_Vtp_d_v_disi__ = 0;
    d_Vtp_d_v_gb__ = 0;
    d_Vtp_d_v_sb__ = 0;
    d_Vtpcorr_d_v_bsi__ = 0;
    d_Vtpcorr_d_v_db__ = 0;
    d_Vtpcorr_d_v_disi__ = 0;
    d_Vtpcorr_d_v_gb__ = 0;
    d_Vtpcorr_d_v_sb__ = 0;
    d_a_d_v_bsi__ = 0;
    d_a_d_v_db__ = 0;
    d_a_d_v_disi__ = 0;
    d_a_d_v_gb__ = 0;
    d_a_d_v_sb__ = 0;
    d_ab_d_v_bsi__ = 0;
    d_ab_d_v_db__ = 0;
    d_ab_d_v_disi__ = 0;
    d_ab_d_v_gb__ = 0;
    d_ab_d_v_sb__ = 0;
    d_dQinv_d_v_bsi__ = 0;
    d_dQinv_d_v_db__ = 0;
    d_dQinv_d_v_disi__ = 0;
    d_dQinv_d_v_gb__ = 0;
    d_dQinv_d_v_sb__ = 0;
    d_dibl_corr_d_v_bsi__ = 0;
    d_dibl_corr_d_v_db__ = 0;
    d_dibl_corr_d_v_disi__ = 0;
    d_dibl_corr_d_v_gb__ = 0;
    d_dibl_corr_d_v_sb__ = 0;
    d_dir_d_v_bsi__ = 0;
    d_dir_d_v_disi__ = 0;
    d_dir_d_v_gb__ = 0;
    d_eVg0_d_v_bsi__ = 0;
    d_eVg0_d_v_disi__ = 0;
    d_eVg0_d_v_gb__ = 0;
    d_eVg_d_v_bsi__ = 0;
    d_eVg_d_v_db__ = 0;
    d_eVg_d_v_disi__ = 0;
    d_eVg_d_v_gb__ = 0;
    d_eVg_d_v_sb__ = 0;
    d_eVgpre_d_v_bsi__ = 0;
    d_eVgpre_d_v_db__ = 0;
    d_eVgpre_d_v_disi__ = 0;
    d_eVgpre_d_v_gb__ = 0;
    d_eVgpre_d_v_sb__ = 0;
    d_eta0_d_v_bsi__ = 0;
    d_eta0_d_v_db__ = 0;
    d_eta0_d_v_disi__ = 0;
    d_eta0_d_v_gb__ = 0;
    d_eta0_d_v_sb__ = 0;
    d_eta_d_v_bsi__ = 0;
    d_eta_d_v_db__ = 0;
    d_eta_d_v_disi__ = 0;
    d_eta_d_v_gb__ = 0;
    d_eta_d_v_sb__ = 0;
    d_etai_d_v_bsi__ = 0;
    d_etai_d_v_db__ = 0;
    d_etai_d_v_disi__ = 0;
    d_etai_d_v_gb__ = 0;
    d_etai_d_v_sb__ = 0;
    d_f_i_bdi_d_v_bsi__ = 0;
    d_f_i_bdi_d_v_db__ = 0;
    d_f_i_bdi_d_v_disi__ = 0;
    d_f_i_bdi_d_v_gb__ = 0;
    d_f_i_bdi_d_v_sb__ = 0;
    d_f_i_bsi_d_v_bsi__ = 0;
    d_f_i_bsi_d_v_db__ = 0;
    d_f_i_bsi_d_v_disi__ = 0;
    d_f_i_bsi_d_v_gb__ = 0;
    d_f_i_bsi_d_v_sb__ = 0;
    d_f_i_ddi_d_v_bsi__ = 0;
    d_f_i_ddi_d_v_db__ = 0;
    d_f_i_ddi_d_v_disi__ = 0;
    d_f_i_disi_d_v_bsi__ = 0;
    d_f_i_disi_d_v_db__ = 0;
    d_f_i_disi_d_v_disi__ = 0;
    d_f_i_disi_d_v_gb__ = 0;
    d_f_i_disi_d_v_sb__ = 0;
    d_f_i_gb_d_v_bsi__ = 0;
    d_f_i_gb_d_v_db__ = 0;
    d_f_i_gb_d_v_disi__ = 0;
    d_f_i_gb_d_v_gb__ = 0;
    d_f_i_gb_d_v_sb__ = 0;
    d_f_i_sis_d_v_bsi__ = 0;
    d_f_i_sis_d_v_sb__ = 0;
    d_kq2_d_v_bsi__ = 0;
    d_kq2_d_v_disi__ = 0;
    d_kq2_d_v_gb__ = 0;
    d_kq4_d_v_bsi__ = 0;
    d_kq4_d_v_disi__ = 0;
    d_kq4_d_v_gb__ = 0;
    d_kq_d_v_bsi__ = 0;
    d_kq_d_v_disi__ = 0;
    d_kq_d_v_gb__ = 0;
    d_n_d_v_bsi__ = 0;
    d_n_d_v_disi__ = 0;
    d_n_d_v_gb__ = 0;
    d_nphit_d_v_bsi__ = 0;
    d_nphit_d_v_disi__ = 0;
    d_nphit_d_v_gb__ = 0;
    d_psis_d_v_bsi__ = 0;
    d_psis_d_v_db__ = 0;
    d_psis_d_v_disi__ = 0;
    d_psis_d_v_gb__ = 0;
    d_psis_d_v_sb__ = 0;
    d_q_i_bdi_d_v_bsi__ = 0;
    d_q_i_bdi_d_v_db__ = 0;
    d_q_i_bdi_d_v_disi__ = 0;
    d_q_i_bdi_d_v_gb__ = 0;
    d_q_i_bdi_d_v_sb__ = 0;
    d_q_i_bsi_d_v_bsi__ = 0;
    d_q_i_bsi_d_v_db__ = 0;
    d_q_i_bsi_d_v_disi__ = 0;
    d_q_i_bsi_d_v_gb__ = 0;
    d_q_i_bsi_d_v_sb__ = 0;
    d_q_i_ddi_d_v_bsi__ = 0;
    d_q_i_ddi_d_v_db__ = 0;
    d_q_i_ddi_d_v_disi__ = 0;
    d_q_i_disi_d_v_bsi__ = 0;
    d_q_i_disi_d_v_db__ = 0;
    d_q_i_disi_d_v_disi__ = 0;
    d_q_i_disi_d_v_gb__ = 0;
    d_q_i_disi_d_v_sb__ = 0;
    d_q_i_gb_d_v_bsi__ = 0;
    d_q_i_gb_d_v_db__ = 0;
    d_q_i_gb_d_v_disi__ = 0;
    d_q_i_gb_d_v_gb__ = 0;
    d_q_i_gb_d_v_sb__ = 0;
    d_q_i_sis_d_v_bsi__ = 0;
    d_q_i_sis_d_v_sb__ = 0;
    d_qd_d_v_bsi__ = 0;
    d_qd_d_v_db__ = 0;
    d_qd_d_v_disi__ = 0;
    d_qd_d_v_gb__ = 0;
    d_qd_d_v_sb__ = 0;
    d_qdb_d_v_bsi__ = 0;
    d_qdb_d_v_db__ = 0;
    d_qdb_d_v_disi__ = 0;
    d_qdb_d_v_gb__ = 0;
    d_qdb_d_v_sb__ = 0;
    d_qdc_d_v_bsi__ = 0;
    d_qdc_d_v_db__ = 0;
    d_qdc_d_v_disi__ = 0;
    d_qdc_d_v_gb__ = 0;
    d_qdc_d_v_sb__ = 0;
    d_qi_d_v_bsi__ = 0;
    d_qi_d_v_db__ = 0;
    d_qi_d_v_disi__ = 0;
    d_qi_d_v_gb__ = 0;
    d_qi_d_v_sb__ = 0;
    d_qs_d_v_bsi__ = 0;
    d_qs_d_v_db__ = 0;
    d_qs_d_v_disi__ = 0;
    d_qs_d_v_gb__ = 0;
    d_qs_d_v_sb__ = 0;
    d_qsb_d_v_bsi__ = 0;
    d_qsb_d_v_db__ = 0;
    d_qsb_d_v_disi__ = 0;
    d_qsb_d_v_gb__ = 0;
    d_qsb_d_v_sb__ = 0;
    d_qsc_d_v_bsi__ = 0;
    d_qsc_d_v_db__ = 0;
    d_qsc_d_v_disi__ = 0;
    d_qsc_d_v_gb__ = 0;
    d_qsc_d_v_sb__ = 0;
    d_v_bdi_d_v_bsi__ = 0;
    d_v_bdi_d_v_disi__ = 0;
    d_v_ddi_d_v_bsi__ = 0;
    d_v_ddi_d_v_db__ = 0;
    d_v_ddi_d_v_disi__ = 0;
    d_v_ds_d_v_db__ = 0;
    d_v_ds_d_v_sb__ = 0;
    d_v_gd_d_v_db__ = 0;
    d_v_gd_d_v_gb__ = 0;
    d_v_gdi_d_v_bsi__ = 0;
    d_v_gdi_d_v_disi__ = 0;
    d_v_gdi_d_v_gb__ = 0;
    d_v_gs_d_v_gb__ = 0;
    d_v_gs_d_v_sb__ = 0;
    d_v_gsi_d_v_bsi__ = 0;
    d_v_gsi_d_v_gb__ = 0;
    d_v_sis_d_v_bsi__ = 0;
    d_v_sis_d_v_sb__ = 0;
    d_x_d_v_bsi__ = 0;
    d_x_d_v_db__ = 0;
    d_x_d_v_disi__ = 0;
    d_x_d_v_gb__ = 0;
    d_x_d_v_sb__ = 0;
    % Initializing inputs
    v_db__ = vecX__(1);
    v_gb__ = vecX__(2);
    v_sb__ = vecX__(3);
    v_disi__ = vecY__(1);
    v_bsi__ = vecY__(2);
    % Initializing remaining IOs and auxiliary IOs
    f_i_gb__ = 0;
    q_i_gb__ = 0;
    f_i_disi__ = 0;
    q_i_disi__ = 0;
    f_i_bsi__ = 0;
    q_i_bsi__ = 0;
    f_i_bdi__ = 0;
    q_i_bdi__ = 0;
    f_i_ddi__ = 0;
    q_i_ddi__ = 0;
    f_i_sis__ = 0;
    q_i_sis__ = 0;
    % module body
    i_gsi__ = 0;
    i_gdi__ = 0;
    i_ds__ = 0;
    i_gs__ = 0;
    i_gd__ = 0;
        d_v_gsi_d_v_gb__ = 1;
        d_v_gsi_d_v_bsi__ = 1;
    v_gsi__ = v_gb__+v_bsi__;
        d_v_gdi_d_v_gb__ = (1);
        d_v_gdi_d_v_disi__ = (-1);
        d_v_gdi_d_v_bsi__ = 1;
    v_gdi__ = (v_gb__-v_disi__)+v_bsi__;
        d_v_ds_d_v_db__ = 1;
        d_v_ds_d_v_sb__ = -1;
    v_ds__ = v_db__-v_sb__;
        d_v_gs_d_v_gb__ = 1;
        d_v_gs_d_v_sb__ = -1;
    v_gs__ = v_gb__-v_sb__;
        d_v_gd_d_v_db__ = -1;
        d_v_gd_d_v_gb__ = 1;
    v_gd__ = v_gb__-v_db__;
        d_v_bdi_d_v_disi__ = -1;
        d_v_bdi_d_v_bsi__ = 1;
    v_bdi__ = -v_disi__+v_bsi__;
        d_v_ddi_d_v_db__ = (1);
        d_v_ddi_d_v_disi__ = (-1);
        d_v_ddi_d_v_bsi__ = 1;
    v_ddi__ = (v_db__-v_disi__)+v_bsi__;
        d_v_sis_d_v_sb__ = -1;
        d_v_sis_d_v_bsi__ = -1;
    v_sis__ = -v_sb__-v_bsi__;
        d_Vgsraw_d_v_gb__ = parm_type*d_v_gsi_d_v_gb__;
        d_Vgsraw_d_v_bsi__ = parm_type*d_v_gsi_d_v_bsi__;
    Vgsraw = parm_type*v_gsi__;
        d_Vgdraw_d_v_gb__ = parm_type*d_v_gdi_d_v_gb__;
        d_Vgdraw_d_v_disi__ = parm_type*d_v_gdi_d_v_disi__;
        d_Vgdraw_d_v_bsi__ = parm_type*d_v_gdi_d_v_bsi__;
    Vgdraw = parm_type*v_gdi__;
    if Vgsraw>=Vgdraw
            d_Vds_d_v_db__ = parm_type*d_v_ds_d_v_db__;
            d_Vds_d_v_gb__ = 0;
            d_Vds_d_v_sb__ = parm_type*d_v_ds_d_v_sb__;
            d_Vds_d_v_disi__ = 0;
            d_Vds_d_v_bsi__ = 0;
        Vds = parm_type*v_ds__;
            d_Vgs_d_v_db__ = 0;
            d_Vgs_d_v_gb__ = parm_type*d_v_gs_d_v_gb__;
            d_Vgs_d_v_sb__ = parm_type*d_v_gs_d_v_sb__;
            d_Vgs_d_v_disi__ = 0;
            d_Vgs_d_v_bsi__ = 0;
        Vgs = parm_type*v_gs__;
            d_Vbs_d_v_db__ = 0;
            d_Vbs_d_v_gb__ = 0;
            d_Vbs_d_v_sb__ = parm_type*-1;
            d_Vbs_d_v_disi__ = 0;
            d_Vbs_d_v_bsi__ = 0;
        Vbs = parm_type*(-v_sb__);
            d_Vdsi_d_v_gb__ = 0;
            d_Vdsi_d_v_disi__ = parm_type*1;
            d_Vdsi_d_v_bsi__ = 0;
        Vdsi = parm_type*v_disi__;
            d_Vgsi_d_v_gb__ = d_Vgsraw_d_v_gb__;
            d_Vgsi_d_v_disi__ = 0;
            d_Vgsi_d_v_bsi__ = d_Vgsraw_d_v_bsi__;
        Vgsi = Vgsraw;
            d_Vbsi_d_v_gb__ = 0;
            d_Vbsi_d_v_disi__ = 0;
            d_Vbsi_d_v_bsi__ = parm_type*1;
        Vbsi = parm_type*v_bsi__;
            d_dir_d_v_gb__ = 0;
            d_dir_d_v_disi__ = 0;
            d_dir_d_v_bsi__ = 0;
        dir = 1;
    else
            d_Vds_d_v_db__ = parm_type*-d_v_ds_d_v_db__;
            d_Vds_d_v_gb__ = 0;
            d_Vds_d_v_sb__ = parm_type*-d_v_ds_d_v_sb__;
            d_Vds_d_v_disi__ = 0;
            d_Vds_d_v_bsi__ = 0;
        Vds = parm_type*(-v_ds__);
            d_Vgs_d_v_db__ = parm_type*d_v_gd_d_v_db__;
            d_Vgs_d_v_gb__ = parm_type*d_v_gd_d_v_gb__;
            d_Vgs_d_v_sb__ = 0;
            d_Vgs_d_v_disi__ = 0;
            d_Vgs_d_v_bsi__ = 0;
        Vgs = parm_type*v_gd__;
            d_Vbs_d_v_db__ = parm_type*-1;
            d_Vbs_d_v_gb__ = 0;
            d_Vbs_d_v_sb__ = 0;
            d_Vbs_d_v_disi__ = 0;
            d_Vbs_d_v_bsi__ = 0;
        Vbs = parm_type*(-v_db__);
            d_Vdsi_d_v_gb__ = 0;
            d_Vdsi_d_v_disi__ = parm_type*-1;
            d_Vdsi_d_v_bsi__ = 0;
        Vdsi = parm_type*(-v_disi__);
            d_Vgsi_d_v_gb__ = d_Vgdraw_d_v_gb__;
            d_Vgsi_d_v_disi__ = d_Vgdraw_d_v_disi__;
            d_Vgsi_d_v_bsi__ = d_Vgdraw_d_v_bsi__;
        Vgsi = Vgdraw;
            d_Vbsi_d_v_gb__ = 0;
            d_Vbsi_d_v_disi__ = parm_type*d_v_bdi_d_v_disi__;
            d_Vbsi_d_v_bsi__ = parm_type*d_v_bdi_d_v_bsi__;
        Vbsi = parm_type*v_bdi__;
            d_dir_d_v_gb__ = 0;
            d_dir_d_v_disi__ = 0;
            d_dir_d_v_bsi__ = 0;
        dir = -1;
    end
    Rs = (0.0001/parm_W)*parm_Rs0;
    Rd = Rs;
    Cofs = ((3.45e-13/parm_etov)*parm_dLg)/2+parm_Cof;
    Cofd = ((3.45e-13/parm_etov)*parm_dLg)/2+parm_Cof;
    Leff = parm_Lgdr-parm_dLg;
    phit = sim_vt_vapp(parm_Tjun);
    me = 9.1e-31*parm_mc;
        d_n_d_v_gb__ = (parm_nd*d_Vdsi_d_v_gb__);
        d_n_d_v_disi__ = (parm_nd*d_Vdsi_d_v_disi__);
        d_n_d_v_bsi__ = (parm_nd*d_Vdsi_d_v_bsi__);
    n = parm_n0+parm_nd*Vdsi;
        d_nphit_d_v_gb__ = d_n_d_v_gb__*phit;
        d_nphit_d_v_disi__ = d_n_d_v_disi__*phit;
        d_nphit_d_v_bsi__ = d_n_d_v_bsi__*phit;
    nphit = n*phit;
    aphit = parm_alpha*phit;
        d_Vtpcorr_d_v_db__ = ((parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbs))))*(sign(parm_phib-Vbs)*(-d_Vbs_d_v_db__)))));
        d_Vtpcorr_d_v_gb__ = ((parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbs))))*(sign(parm_phib-Vbs)*(-d_Vbs_d_v_gb__)))))-(d_Vdsi_d_v_gb__*parm_delta);
        d_Vtpcorr_d_v_sb__ = ((parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbs))))*(sign(parm_phib-Vbs)*(-d_Vbs_d_v_sb__)))));
        d_Vtpcorr_d_v_disi__ = ((parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbs))))*(sign(parm_phib-Vbs)*(-d_Vbs_d_v_disi__)))))-(d_Vdsi_d_v_disi__*parm_delta);
        d_Vtpcorr_d_v_bsi__ = ((parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbs))))*(sign(parm_phib-Vbs)*(-d_Vbs_d_v_bsi__)))))-(d_Vdsi_d_v_bsi__*parm_delta);
    Vtpcorr = (parm_Vt0+parm_gamma*(sqrt(abs(parm_phib-Vbs))-sqrt(parm_phib)))-Vdsi*parm_delta;
        d_eVgpre_d_v_db__ = exp((Vgs-Vtpcorr)/(aphit*1.5))*((d_Vgs_d_v_db__-d_Vtpcorr_d_v_db__)/(aphit*1.5));
        d_eVgpre_d_v_gb__ = exp((Vgs-Vtpcorr)/(aphit*1.5))*((d_Vgs_d_v_gb__-d_Vtpcorr_d_v_gb__)/(aphit*1.5));
        d_eVgpre_d_v_sb__ = exp((Vgs-Vtpcorr)/(aphit*1.5))*((d_Vgs_d_v_sb__-d_Vtpcorr_d_v_sb__)/(aphit*1.5));
        d_eVgpre_d_v_disi__ = exp((Vgs-Vtpcorr)/(aphit*1.5))*((d_Vgs_d_v_disi__-d_Vtpcorr_d_v_disi__)/(aphit*1.5));
        d_eVgpre_d_v_bsi__ = exp((Vgs-Vtpcorr)/(aphit*1.5))*((d_Vgs_d_v_bsi__-d_Vtpcorr_d_v_bsi__)/(aphit*1.5));
    eVgpre = exp((Vgs-Vtpcorr)/(aphit*1.5));
        d_FFpre_d_v_db__ = -(1*(d_eVgpre_d_v_db__))/(1+eVgpre)^2;
        d_FFpre_d_v_gb__ = -(1*(d_eVgpre_d_v_gb__))/(1+eVgpre)^2;
        d_FFpre_d_v_sb__ = -(1*(d_eVgpre_d_v_sb__))/(1+eVgpre)^2;
        d_FFpre_d_v_disi__ = -(1*(d_eVgpre_d_v_disi__))/(1+eVgpre)^2;
        d_FFpre_d_v_bsi__ = -(1*(d_eVgpre_d_v_bsi__))/(1+eVgpre)^2;
    FFpre = 1/(1+eVgpre);
        d_ab_d_v_db__ = (2*(-(0.99*d_FFpre_d_v_db__)))*phit;
        d_ab_d_v_gb__ = (2*(-(0.99*d_FFpre_d_v_gb__)))*phit;
        d_ab_d_v_sb__ = (2*(-(0.99*d_FFpre_d_v_sb__)))*phit;
        d_ab_d_v_disi__ = (2*(-(0.99*d_FFpre_d_v_disi__)))*phit;
        d_ab_d_v_bsi__ = (2*(-(0.99*d_FFpre_d_v_bsi__)))*phit;
    ab = (2*(1-0.99*FFpre))*phit;
        d_Vcorr_d_v_db__ = ((1+2*parm_delta)*(ab/2))*(exp(-Vdsi/ab)*(-(-Vdsi*d_ab_d_v_db__)/ab^2))+((1+2*parm_delta)*(d_ab_d_v_db__/2))*exp(-Vdsi/ab);
        d_Vcorr_d_v_gb__ = ((1+2*parm_delta)*(ab/2))*(exp(-Vdsi/ab)*(-d_Vdsi_d_v_gb__/ab-(-Vdsi*d_ab_d_v_gb__)/ab^2))+((1+2*parm_delta)*(d_ab_d_v_gb__/2))*exp(-Vdsi/ab);
        d_Vcorr_d_v_sb__ = ((1+2*parm_delta)*(ab/2))*(exp(-Vdsi/ab)*(-(-Vdsi*d_ab_d_v_sb__)/ab^2))+((1+2*parm_delta)*(d_ab_d_v_sb__/2))*exp(-Vdsi/ab);
        d_Vcorr_d_v_disi__ = ((1+2*parm_delta)*(ab/2))*(exp(-Vdsi/ab)*(-d_Vdsi_d_v_disi__/ab-(-Vdsi*d_ab_d_v_disi__)/ab^2))+((1+2*parm_delta)*(d_ab_d_v_disi__/2))*exp(-Vdsi/ab);
        d_Vcorr_d_v_bsi__ = ((1+2*parm_delta)*(ab/2))*(exp(-Vdsi/ab)*(-d_Vdsi_d_v_bsi__/ab-(-Vdsi*d_ab_d_v_bsi__)/ab^2))+((1+2*parm_delta)*(d_ab_d_v_bsi__/2))*exp(-Vdsi/ab);
    Vcorr = ((1+2*parm_delta)*(ab/2))*exp(-Vdsi/ab);
        d_Vgscorr_d_v_db__ = d_Vcorr_d_v_db__;
        d_Vgscorr_d_v_gb__ = d_Vgsi_d_v_gb__+d_Vcorr_d_v_gb__;
        d_Vgscorr_d_v_sb__ = d_Vcorr_d_v_sb__;
        d_Vgscorr_d_v_disi__ = d_Vgsi_d_v_disi__+d_Vcorr_d_v_disi__;
        d_Vgscorr_d_v_bsi__ = d_Vgsi_d_v_bsi__+d_Vcorr_d_v_bsi__;
    Vgscorr = Vgsi+Vcorr;
        d_Vbscorr_d_v_db__ = d_Vcorr_d_v_db__;
        d_Vbscorr_d_v_gb__ = d_Vbsi_d_v_gb__+d_Vcorr_d_v_gb__;
        d_Vbscorr_d_v_sb__ = d_Vcorr_d_v_sb__;
        d_Vbscorr_d_v_disi__ = d_Vbsi_d_v_disi__+d_Vcorr_d_v_disi__;
        d_Vbscorr_d_v_bsi__ = d_Vbsi_d_v_bsi__+d_Vcorr_d_v_bsi__;
    Vbscorr = Vbsi+Vcorr;
        d_Vt0bs_d_v_db__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbscorr))))*(sign(parm_phib-Vbscorr)*(-d_Vbscorr_d_v_db__))));
        d_Vt0bs_d_v_gb__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbscorr))))*(sign(parm_phib-Vbscorr)*(-d_Vbscorr_d_v_gb__))));
        d_Vt0bs_d_v_sb__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbscorr))))*(sign(parm_phib-Vbscorr)*(-d_Vbscorr_d_v_sb__))));
        d_Vt0bs_d_v_disi__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbscorr))))*(sign(parm_phib-Vbscorr)*(-d_Vbscorr_d_v_disi__))));
        d_Vt0bs_d_v_bsi__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbscorr))))*(sign(parm_phib-Vbscorr)*(-d_Vbscorr_d_v_bsi__))));
    Vt0bs = parm_Vt0+parm_gamma*(sqrt(abs(parm_phib-Vbscorr))-sqrt(parm_phib));
        d_Vt0bs0_d_v_gb__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbsi))))*(sign(parm_phib-Vbsi)*(-d_Vbsi_d_v_gb__))));
        d_Vt0bs0_d_v_disi__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbsi))))*(sign(parm_phib-Vbsi)*(-d_Vbsi_d_v_disi__))));
        d_Vt0bs0_d_v_bsi__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-Vbsi))))*(sign(parm_phib-Vbsi)*(-d_Vbsi_d_v_bsi__))));
    Vt0bs0 = parm_Vt0+parm_gamma*(sqrt(abs(parm_phib-Vbsi))-sqrt(parm_phib));
        d_Vtp_d_v_db__ = (d_Vt0bs_d_v_db__);
        d_Vtp_d_v_gb__ = (d_Vt0bs_d_v_gb__-(d_Vdsi_d_v_gb__*parm_delta));
        d_Vtp_d_v_sb__ = (d_Vt0bs_d_v_sb__);
        d_Vtp_d_v_disi__ = (d_Vt0bs_d_v_disi__-(d_Vdsi_d_v_disi__*parm_delta));
        d_Vtp_d_v_bsi__ = (d_Vt0bs_d_v_bsi__-(d_Vdsi_d_v_bsi__*parm_delta));
    Vtp = (Vt0bs-Vdsi*parm_delta)-0.5*aphit;
        d_Vtp0_d_v_gb__ = (d_Vt0bs0_d_v_gb__-(d_Vdsi_d_v_gb__*parm_delta));
        d_Vtp0_d_v_disi__ = (d_Vt0bs0_d_v_disi__-(d_Vdsi_d_v_disi__*parm_delta));
        d_Vtp0_d_v_bsi__ = (d_Vt0bs0_d_v_bsi__-(d_Vdsi_d_v_bsi__*parm_delta));
    Vtp0 = (Vt0bs0-Vdsi*parm_delta)-0.5*aphit;
        d_eVg_d_v_db__ = exp((Vgscorr-Vtp)/aphit)*((d_Vgscorr_d_v_db__-d_Vtp_d_v_db__)/aphit);
        d_eVg_d_v_gb__ = exp((Vgscorr-Vtp)/aphit)*((d_Vgscorr_d_v_gb__-d_Vtp_d_v_gb__)/aphit);
        d_eVg_d_v_sb__ = exp((Vgscorr-Vtp)/aphit)*((d_Vgscorr_d_v_sb__-d_Vtp_d_v_sb__)/aphit);
        d_eVg_d_v_disi__ = exp((Vgscorr-Vtp)/aphit)*((d_Vgscorr_d_v_disi__-d_Vtp_d_v_disi__)/aphit);
        d_eVg_d_v_bsi__ = exp((Vgscorr-Vtp)/aphit)*((d_Vgscorr_d_v_bsi__-d_Vtp_d_v_bsi__)/aphit);
    eVg = exp((Vgscorr-Vtp)/aphit);
        d_FF_d_v_db__ = -(1*(d_eVg_d_v_db__))/(1+eVg)^2;
        d_FF_d_v_gb__ = -(1*(d_eVg_d_v_gb__))/(1+eVg)^2;
        d_FF_d_v_sb__ = -(1*(d_eVg_d_v_sb__))/(1+eVg)^2;
        d_FF_d_v_disi__ = -(1*(d_eVg_d_v_disi__))/(1+eVg)^2;
        d_FF_d_v_bsi__ = -(1*(d_eVg_d_v_bsi__))/(1+eVg)^2;
    FF = 1/(1+eVg);
        d_eVg0_d_v_gb__ = exp((Vgsi-Vtp0)/aphit)*((d_Vgsi_d_v_gb__-d_Vtp0_d_v_gb__)/aphit);
        d_eVg0_d_v_disi__ = exp((Vgsi-Vtp0)/aphit)*((d_Vgsi_d_v_disi__-d_Vtp0_d_v_disi__)/aphit);
        d_eVg0_d_v_bsi__ = exp((Vgsi-Vtp0)/aphit)*((d_Vgsi_d_v_bsi__-d_Vtp0_d_v_bsi__)/aphit);
    eVg0 = exp((Vgsi-Vtp0)/aphit);
        d_FF0_d_v_gb__ = -(1*(d_eVg0_d_v_gb__))/(1+eVg0)^2;
        d_FF0_d_v_disi__ = -(1*(d_eVg0_d_v_disi__))/(1+eVg0)^2;
        d_FF0_d_v_bsi__ = -(1*(d_eVg0_d_v_bsi__))/(1+eVg0)^2;
    FF0 = 1/(1+eVg0);
        d_Qref_d_v_gb__ = parm_Cg*d_nphit_d_v_gb__;
        d_Qref_d_v_disi__ = parm_Cg*d_nphit_d_v_disi__;
        d_Qref_d_v_bsi__ = parm_Cg*d_nphit_d_v_bsi__;
    Qref = parm_Cg*nphit;
        d_eta_d_v_db__ = (d_Vgscorr_d_v_db__-((d_Vt0bs_d_v_db__)-(d_FF_d_v_db__*aphit)))/nphit;
        d_eta_d_v_gb__ = (d_Vgscorr_d_v_gb__-((d_Vt0bs_d_v_gb__-(d_Vdsi_d_v_gb__*parm_delta))-(d_FF_d_v_gb__*aphit)))/nphit-((Vgscorr-((Vt0bs-Vdsi*parm_delta)-FF*aphit))*d_nphit_d_v_gb__)/nphit^2;
        d_eta_d_v_sb__ = (d_Vgscorr_d_v_sb__-((d_Vt0bs_d_v_sb__)-(d_FF_d_v_sb__*aphit)))/nphit;
        d_eta_d_v_disi__ = (d_Vgscorr_d_v_disi__-((d_Vt0bs_d_v_disi__-(d_Vdsi_d_v_disi__*parm_delta))-(d_FF_d_v_disi__*aphit)))/nphit-((Vgscorr-((Vt0bs-Vdsi*parm_delta)-FF*aphit))*d_nphit_d_v_disi__)/nphit^2;
        d_eta_d_v_bsi__ = (d_Vgscorr_d_v_bsi__-((d_Vt0bs_d_v_bsi__-(d_Vdsi_d_v_bsi__*parm_delta))-(d_FF_d_v_bsi__*aphit)))/nphit-((Vgscorr-((Vt0bs-Vdsi*parm_delta)-FF*aphit))*d_nphit_d_v_bsi__)/nphit^2;
    eta = (Vgscorr-((Vt0bs-Vdsi*parm_delta)-FF*aphit))/nphit;
        d_eta0_d_v_db__ = (-(-(d_FF_d_v_db__*aphit)))/nphit;
        d_eta0_d_v_gb__ = (d_Vgsi_d_v_gb__-((d_Vt0bs0_d_v_gb__-(d_Vdsi_d_v_gb__*parm_delta))-(d_FF_d_v_gb__*aphit)))/nphit-((Vgsi-((Vt0bs0-Vdsi*parm_delta)-FF*aphit))*d_nphit_d_v_gb__)/nphit^2;
        d_eta0_d_v_sb__ = (-(-(d_FF_d_v_sb__*aphit)))/nphit;
        d_eta0_d_v_disi__ = (d_Vgsi_d_v_disi__-((d_Vt0bs0_d_v_disi__-(d_Vdsi_d_v_disi__*parm_delta))-(d_FF_d_v_disi__*aphit)))/nphit-((Vgsi-((Vt0bs0-Vdsi*parm_delta)-FF*aphit))*d_nphit_d_v_disi__)/nphit^2;
        d_eta0_d_v_bsi__ = (d_Vgsi_d_v_bsi__-((d_Vt0bs0_d_v_bsi__-(d_Vdsi_d_v_bsi__*parm_delta))-(d_FF_d_v_bsi__*aphit)))/nphit-((Vgsi-((Vt0bs0-Vdsi*parm_delta)-FF*aphit))*d_nphit_d_v_bsi__)/nphit^2;
    eta0 = (Vgsi-((Vt0bs0-Vdsi*parm_delta)-FF*aphit))/nphit;
    if eta<=40
            d_Qinv_corr_d_v_db__ = Qref*((1/(1+exp(eta)))*(exp(eta)*d_eta_d_v_db__));
            d_Qinv_corr_d_v_gb__ = Qref*((1/(1+exp(eta)))*(exp(eta)*d_eta_d_v_gb__))+d_Qref_d_v_gb__*log(1+exp(eta));
            d_Qinv_corr_d_v_sb__ = Qref*((1/(1+exp(eta)))*(exp(eta)*d_eta_d_v_sb__));
            d_Qinv_corr_d_v_disi__ = Qref*((1/(1+exp(eta)))*(exp(eta)*d_eta_d_v_disi__))+d_Qref_d_v_disi__*log(1+exp(eta));
            d_Qinv_corr_d_v_bsi__ = Qref*((1/(1+exp(eta)))*(exp(eta)*d_eta_d_v_bsi__))+d_Qref_d_v_bsi__*log(1+exp(eta));
        Qinv_corr = Qref*log(1+exp(eta));
    else
            d_Qinv_corr_d_v_db__ = Qref*d_eta_d_v_db__;
            d_Qinv_corr_d_v_gb__ = Qref*d_eta_d_v_gb__+d_Qref_d_v_gb__*eta;
            d_Qinv_corr_d_v_sb__ = Qref*d_eta_d_v_sb__;
            d_Qinv_corr_d_v_disi__ = Qref*d_eta_d_v_disi__+d_Qref_d_v_disi__*eta;
            d_Qinv_corr_d_v_bsi__ = Qref*d_eta_d_v_bsi__+d_Qref_d_v_bsi__*eta;
        Qinv_corr = Qref*eta;
    end
    if eta0<=40
            d_Qinv_d_v_db__ = Qref*((1/(1+exp(eta0)))*(exp(eta0)*d_eta0_d_v_db__));
            d_Qinv_d_v_gb__ = Qref*((1/(1+exp(eta0)))*(exp(eta0)*d_eta0_d_v_gb__))+d_Qref_d_v_gb__*log(1+exp(eta0));
            d_Qinv_d_v_sb__ = Qref*((1/(1+exp(eta0)))*(exp(eta0)*d_eta0_d_v_sb__));
            d_Qinv_d_v_disi__ = Qref*((1/(1+exp(eta0)))*(exp(eta0)*d_eta0_d_v_disi__))+d_Qref_d_v_disi__*log(1+exp(eta0));
            d_Qinv_d_v_bsi__ = Qref*((1/(1+exp(eta0)))*(exp(eta0)*d_eta0_d_v_bsi__))+d_Qref_d_v_bsi__*log(1+exp(eta0));
        Qinv = Qref*log(1+exp(eta0));
    else
            d_Qinv_d_v_db__ = Qref*d_eta0_d_v_db__;
            d_Qinv_d_v_gb__ = Qref*d_eta0_d_v_gb__+d_Qref_d_v_gb__*eta0;
            d_Qinv_d_v_sb__ = Qref*d_eta0_d_v_sb__;
            d_Qinv_d_v_disi__ = Qref*d_eta0_d_v_disi__+d_Qref_d_v_disi__*eta0;
            d_Qinv_d_v_bsi__ = Qref*d_eta0_d_v_bsi__+d_Qref_d_v_bsi__*eta0;
        Qinv = Qref*eta0;
    end
    vx0 = parm_vxo;
    Vdsats = (vx0*Leff)/parm_mu;
        d_Vdsat_d_v_db__ = (Vdsats*(-d_FF_d_v_db__))+(phit*d_FF_d_v_db__);
        d_Vdsat_d_v_gb__ = (Vdsats*(-d_FF_d_v_gb__))+(phit*d_FF_d_v_gb__);
        d_Vdsat_d_v_sb__ = (Vdsats*(-d_FF_d_v_sb__))+(phit*d_FF_d_v_sb__);
        d_Vdsat_d_v_disi__ = (Vdsats*(-d_FF_d_v_disi__))+(phit*d_FF_d_v_disi__);
        d_Vdsat_d_v_bsi__ = (Vdsats*(-d_FF_d_v_bsi__))+(phit*d_FF_d_v_bsi__);
    Vdsat = Vdsats*(1-FF)+phit*FF;
        d_Vdratio_d_v_db__ = sign(Vdsi/Vdsat)*(-(Vdsi*d_Vdsat_d_v_db__)/Vdsat^2);
        d_Vdratio_d_v_gb__ = sign(Vdsi/Vdsat)*(d_Vdsi_d_v_gb__/Vdsat-(Vdsi*d_Vdsat_d_v_gb__)/Vdsat^2);
        d_Vdratio_d_v_sb__ = sign(Vdsi/Vdsat)*(-(Vdsi*d_Vdsat_d_v_sb__)/Vdsat^2);
        d_Vdratio_d_v_disi__ = sign(Vdsi/Vdsat)*(d_Vdsi_d_v_disi__/Vdsat-(Vdsi*d_Vdsat_d_v_disi__)/Vdsat^2);
        d_Vdratio_d_v_bsi__ = sign(Vdsi/Vdsat)*(d_Vdsi_d_v_bsi__/Vdsat-(Vdsi*d_Vdsat_d_v_bsi__)/Vdsat^2);
    Vdratio = abs(Vdsi/Vdsat);
        d_Vdbeta_d_v_db__ = d_pow_vapp_d_arg1__(Vdratio, parm_beta)*d_Vdratio_d_v_db__;
        d_Vdbeta_d_v_gb__ = d_pow_vapp_d_arg1__(Vdratio, parm_beta)*d_Vdratio_d_v_gb__;
        d_Vdbeta_d_v_sb__ = d_pow_vapp_d_arg1__(Vdratio, parm_beta)*d_Vdratio_d_v_sb__;
        d_Vdbeta_d_v_disi__ = d_pow_vapp_d_arg1__(Vdratio, parm_beta)*d_Vdratio_d_v_disi__;
        d_Vdbeta_d_v_bsi__ = d_pow_vapp_d_arg1__(Vdratio, parm_beta)*d_Vdratio_d_v_bsi__;
    Vdbeta = pow_vapp(Vdratio, parm_beta);
        d_Vdbetabeta_d_v_db__ = d_pow_vapp_d_arg1__(1+Vdbeta, 1/parm_beta)*(d_Vdbeta_d_v_db__);
        d_Vdbetabeta_d_v_gb__ = d_pow_vapp_d_arg1__(1+Vdbeta, 1/parm_beta)*(d_Vdbeta_d_v_gb__);
        d_Vdbetabeta_d_v_sb__ = d_pow_vapp_d_arg1__(1+Vdbeta, 1/parm_beta)*(d_Vdbeta_d_v_sb__);
        d_Vdbetabeta_d_v_disi__ = d_pow_vapp_d_arg1__(1+Vdbeta, 1/parm_beta)*(d_Vdbeta_d_v_disi__);
        d_Vdbetabeta_d_v_bsi__ = d_pow_vapp_d_arg1__(1+Vdbeta, 1/parm_beta)*(d_Vdbeta_d_v_bsi__);
    Vdbetabeta = pow_vapp(1+Vdbeta, 1/parm_beta);
        d_Fsat_d_v_db__ = d_Vdratio_d_v_db__/Vdbetabeta-(Vdratio*d_Vdbetabeta_d_v_db__)/Vdbetabeta^2;
        d_Fsat_d_v_gb__ = d_Vdratio_d_v_gb__/Vdbetabeta-(Vdratio*d_Vdbetabeta_d_v_gb__)/Vdbetabeta^2;
        d_Fsat_d_v_sb__ = d_Vdratio_d_v_sb__/Vdbetabeta-(Vdratio*d_Vdbetabeta_d_v_sb__)/Vdbetabeta^2;
        d_Fsat_d_v_disi__ = d_Vdratio_d_v_disi__/Vdbetabeta-(Vdratio*d_Vdbetabeta_d_v_disi__)/Vdbetabeta^2;
        d_Fsat_d_v_bsi__ = d_Vdratio_d_v_bsi__/Vdbetabeta-(Vdratio*d_Vdbetabeta_d_v_bsi__)/Vdbetabeta^2;
    Fsat = Vdratio/Vdbetabeta;
        d_Id_d_v_db__ = ((Qinv_corr*vx0)*d_Fsat_d_v_db__+(d_Qinv_corr_d_v_db__*vx0)*Fsat)*parm_W;
        d_Id_d_v_gb__ = ((Qinv_corr*vx0)*d_Fsat_d_v_gb__+(d_Qinv_corr_d_v_gb__*vx0)*Fsat)*parm_W;
        d_Id_d_v_sb__ = ((Qinv_corr*vx0)*d_Fsat_d_v_sb__+(d_Qinv_corr_d_v_sb__*vx0)*Fsat)*parm_W;
        d_Id_d_v_disi__ = ((Qinv_corr*vx0)*d_Fsat_d_v_disi__+(d_Qinv_corr_d_v_disi__*vx0)*Fsat)*parm_W;
        d_Id_d_v_bsi__ = ((Qinv_corr*vx0)*d_Fsat_d_v_bsi__+(d_Qinv_corr_d_v_bsi__*vx0)*Fsat)*parm_W;
    Id = ((Qinv_corr*vx0)*Fsat)*parm_W;
        d_Vgt_d_v_db__ = d_Qinv_d_v_db__/parm_Cg;
        d_Vgt_d_v_gb__ = d_Qinv_d_v_gb__/parm_Cg;
        d_Vgt_d_v_sb__ = d_Qinv_d_v_sb__/parm_Cg;
        d_Vgt_d_v_disi__ = d_Qinv_d_v_disi__/parm_Cg;
        d_Vgt_d_v_bsi__ = d_Qinv_d_v_bsi__/parm_Cg;
    Vgt = Qinv/parm_Cg;
    if parm_gamma==0
            d_a_d_v_db__ = 0;
            d_a_d_v_gb__ = 0;
            d_a_d_v_sb__ = 0;
            d_a_d_v_disi__ = 0;
            d_a_d_v_bsi__ = 0;
        a = 1;
        if eta0<=40
                d_psis_d_v_db__ = (phit*((1/log((1+1e-10)+exp(eta0)))*((1/((1+1e-10)+exp(eta0)))*(exp(eta0)*d_eta0_d_v_db__))));
                d_psis_d_v_gb__ = (phit*((1/log((1+1e-10)+exp(eta0)))*((1/((1+1e-10)+exp(eta0)))*(exp(eta0)*d_eta0_d_v_gb__))));
                d_psis_d_v_sb__ = (phit*((1/log((1+1e-10)+exp(eta0)))*((1/((1+1e-10)+exp(eta0)))*(exp(eta0)*d_eta0_d_v_sb__))));
                d_psis_d_v_disi__ = (phit*((1/log((1+1e-10)+exp(eta0)))*((1/((1+1e-10)+exp(eta0)))*(exp(eta0)*d_eta0_d_v_disi__))));
                d_psis_d_v_bsi__ = (phit*((1/log((1+1e-10)+exp(eta0)))*((1/((1+1e-10)+exp(eta0)))*(exp(eta0)*d_eta0_d_v_bsi__))));
            psis = parm_phib+phit*(1+log(log((1+1e-10)+exp(eta0))));
        else
                d_psis_d_v_db__ = (phit*((1/eta0)*d_eta0_d_v_db__));
                d_psis_d_v_gb__ = (phit*((1/eta0)*d_eta0_d_v_gb__));
                d_psis_d_v_sb__ = (phit*((1/eta0)*d_eta0_d_v_sb__));
                d_psis_d_v_disi__ = (phit*((1/eta0)*d_eta0_d_v_disi__));
                d_psis_d_v_bsi__ = (phit*((1/eta0)*d_eta0_d_v_bsi__));
            psis = parm_phib+phit*(1+log(eta0));
        end
    else
        if eta0<=40
                d_psis_d_v_db__ = ((((1-parm_gamma)/(1+parm_gamma))*phit)*((1/log((1+1e-10)+exp(eta0)))*((1/((1+1e-10)+exp(eta0)))*(exp(eta0)*d_eta0_d_v_db__))));
                d_psis_d_v_gb__ = ((((1-parm_gamma)/(1+parm_gamma))*phit)*((1/log((1+1e-10)+exp(eta0)))*((1/((1+1e-10)+exp(eta0)))*(exp(eta0)*d_eta0_d_v_gb__))));
                d_psis_d_v_sb__ = ((((1-parm_gamma)/(1+parm_gamma))*phit)*((1/log((1+1e-10)+exp(eta0)))*((1/((1+1e-10)+exp(eta0)))*(exp(eta0)*d_eta0_d_v_sb__))));
                d_psis_d_v_disi__ = ((((1-parm_gamma)/(1+parm_gamma))*phit)*((1/log((1+1e-10)+exp(eta0)))*((1/((1+1e-10)+exp(eta0)))*(exp(eta0)*d_eta0_d_v_disi__))));
                d_psis_d_v_bsi__ = ((((1-parm_gamma)/(1+parm_gamma))*phit)*((1/log((1+1e-10)+exp(eta0)))*((1/((1+1e-10)+exp(eta0)))*(exp(eta0)*d_eta0_d_v_bsi__))));
            psis = parm_phib+(((1-parm_gamma)/(1+parm_gamma))*phit)*(1+log(log((1+1e-10)+exp(eta0))));
        else
                d_psis_d_v_db__ = ((((1-parm_gamma)/(1+parm_gamma))*phit)*((1/eta0)*d_eta0_d_v_db__));
                d_psis_d_v_gb__ = ((((1-parm_gamma)/(1+parm_gamma))*phit)*((1/eta0)*d_eta0_d_v_gb__));
                d_psis_d_v_sb__ = ((((1-parm_gamma)/(1+parm_gamma))*phit)*((1/eta0)*d_eta0_d_v_sb__));
                d_psis_d_v_disi__ = ((((1-parm_gamma)/(1+parm_gamma))*phit)*((1/eta0)*d_eta0_d_v_disi__));
                d_psis_d_v_bsi__ = ((((1-parm_gamma)/(1+parm_gamma))*phit)*((1/eta0)*d_eta0_d_v_bsi__));
            psis = parm_phib+(((1-parm_gamma)/(1+parm_gamma))*phit)*(1+log(eta0));
        end
            d_a_d_v_db__ = (-(parm_gamma*(2*((1/(2*sqrt(abs(psis-Vbsi))))*(sign(psis-Vbsi)*(d_psis_d_v_db__)))))/(2*sqrt(abs(psis-Vbsi)))^2);
            d_a_d_v_gb__ = (-(parm_gamma*(2*((1/(2*sqrt(abs(psis-Vbsi))))*(sign(psis-Vbsi)*(d_psis_d_v_gb__-d_Vbsi_d_v_gb__)))))/(2*sqrt(abs(psis-Vbsi)))^2);
            d_a_d_v_sb__ = (-(parm_gamma*(2*((1/(2*sqrt(abs(psis-Vbsi))))*(sign(psis-Vbsi)*(d_psis_d_v_sb__)))))/(2*sqrt(abs(psis-Vbsi)))^2);
            d_a_d_v_disi__ = (-(parm_gamma*(2*((1/(2*sqrt(abs(psis-Vbsi))))*(sign(psis-Vbsi)*(d_psis_d_v_disi__-d_Vbsi_d_v_disi__)))))/(2*sqrt(abs(psis-Vbsi)))^2);
            d_a_d_v_bsi__ = (-(parm_gamma*(2*((1/(2*sqrt(abs(psis-Vbsi))))*(sign(psis-Vbsi)*(d_psis_d_v_bsi__-d_Vbsi_d_v_bsi__)))))/(2*sqrt(abs(psis-Vbsi)))^2);
        a = 1+parm_gamma/(2*sqrt(abs(psis-Vbsi)));
    end
        d_Vgta_d_v_db__ = d_Vgt_d_v_db__/a-(Vgt*d_a_d_v_db__)/a^2;
        d_Vgta_d_v_gb__ = d_Vgt_d_v_gb__/a-(Vgt*d_a_d_v_gb__)/a^2;
        d_Vgta_d_v_sb__ = d_Vgt_d_v_sb__/a-(Vgt*d_a_d_v_sb__)/a^2;
        d_Vgta_d_v_disi__ = d_Vgt_d_v_disi__/a-(Vgt*d_a_d_v_disi__)/a^2;
        d_Vgta_d_v_bsi__ = d_Vgt_d_v_bsi__/a-(Vgt*d_a_d_v_bsi__)/a^2;
    Vgta = Vgt/a;
        d_Vdsatq_d_v_db__ = (1/(2*sqrt((FF0*aphit)*aphit+Vgta*Vgta)))*((Vgta*d_Vgta_d_v_db__+d_Vgta_d_v_db__*Vgta));
        d_Vdsatq_d_v_gb__ = (1/(2*sqrt((FF0*aphit)*aphit+Vgta*Vgta)))*(((d_FF0_d_v_gb__*aphit)*aphit)+(Vgta*d_Vgta_d_v_gb__+d_Vgta_d_v_gb__*Vgta));
        d_Vdsatq_d_v_sb__ = (1/(2*sqrt((FF0*aphit)*aphit+Vgta*Vgta)))*((Vgta*d_Vgta_d_v_sb__+d_Vgta_d_v_sb__*Vgta));
        d_Vdsatq_d_v_disi__ = (1/(2*sqrt((FF0*aphit)*aphit+Vgta*Vgta)))*(((d_FF0_d_v_disi__*aphit)*aphit)+(Vgta*d_Vgta_d_v_disi__+d_Vgta_d_v_disi__*Vgta));
        d_Vdsatq_d_v_bsi__ = (1/(2*sqrt((FF0*aphit)*aphit+Vgta*Vgta)))*(((d_FF0_d_v_bsi__*aphit)*aphit)+(Vgta*d_Vgta_d_v_bsi__+d_Vgta_d_v_bsi__*Vgta));
    Vdsatq = sqrt((FF0*aphit)*aphit+Vgta*Vgta);
        d_Fsatq_d_v_db__ = (sign(Vdsi/Vdsatq)*(-(Vdsi*d_Vdsatq_d_v_db__)/Vdsatq^2))/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)-(abs(Vdsi/Vdsatq)*(d_pow_vapp_d_arg1__(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)*(d_pow_vapp_d_arg1__(abs(Vdsi/Vdsatq), parm_beta)*(sign(Vdsi/Vdsatq)*(-(Vdsi*d_Vdsatq_d_v_db__)/Vdsatq^2)))))/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)^2;
        d_Fsatq_d_v_gb__ = (sign(Vdsi/Vdsatq)*(d_Vdsi_d_v_gb__/Vdsatq-(Vdsi*d_Vdsatq_d_v_gb__)/Vdsatq^2))/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)-(abs(Vdsi/Vdsatq)*(d_pow_vapp_d_arg1__(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)*(d_pow_vapp_d_arg1__(abs(Vdsi/Vdsatq), parm_beta)*(sign(Vdsi/Vdsatq)*(d_Vdsi_d_v_gb__/Vdsatq-(Vdsi*d_Vdsatq_d_v_gb__)/Vdsatq^2)))))/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)^2;
        d_Fsatq_d_v_sb__ = (sign(Vdsi/Vdsatq)*(-(Vdsi*d_Vdsatq_d_v_sb__)/Vdsatq^2))/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)-(abs(Vdsi/Vdsatq)*(d_pow_vapp_d_arg1__(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)*(d_pow_vapp_d_arg1__(abs(Vdsi/Vdsatq), parm_beta)*(sign(Vdsi/Vdsatq)*(-(Vdsi*d_Vdsatq_d_v_sb__)/Vdsatq^2)))))/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)^2;
        d_Fsatq_d_v_disi__ = (sign(Vdsi/Vdsatq)*(d_Vdsi_d_v_disi__/Vdsatq-(Vdsi*d_Vdsatq_d_v_disi__)/Vdsatq^2))/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)-(abs(Vdsi/Vdsatq)*(d_pow_vapp_d_arg1__(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)*(d_pow_vapp_d_arg1__(abs(Vdsi/Vdsatq), parm_beta)*(sign(Vdsi/Vdsatq)*(d_Vdsi_d_v_disi__/Vdsatq-(Vdsi*d_Vdsatq_d_v_disi__)/Vdsatq^2)))))/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)^2;
        d_Fsatq_d_v_bsi__ = (sign(Vdsi/Vdsatq)*(d_Vdsi_d_v_bsi__/Vdsatq-(Vdsi*d_Vdsatq_d_v_bsi__)/Vdsatq^2))/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)-(abs(Vdsi/Vdsatq)*(d_pow_vapp_d_arg1__(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)*(d_pow_vapp_d_arg1__(abs(Vdsi/Vdsatq), parm_beta)*(sign(Vdsi/Vdsatq)*(d_Vdsi_d_v_bsi__/Vdsatq-(Vdsi*d_Vdsatq_d_v_bsi__)/Vdsatq^2)))))/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta)^2;
    Fsatq = abs(Vdsi/Vdsatq)/pow_vapp(1+pow_vapp(abs(Vdsi/Vdsatq), parm_beta), 1/parm_beta);
        d_x_d_v_db__ = -d_Fsatq_d_v_db__;
        d_x_d_v_gb__ = -d_Fsatq_d_v_gb__;
        d_x_d_v_sb__ = -d_Fsatq_d_v_sb__;
        d_x_d_v_disi__ = -d_Fsatq_d_v_disi__;
        d_x_d_v_bsi__ = -d_Fsatq_d_v_bsi__;
    x = 1-Fsatq;
        d_A_d_v_db__ = (d_pow_vapp_d_arg1__(1-x, 2)*(-d_x_d_v_db__))/(12*(1-(1-x)/2))-(pow_vapp(1-x, 2)*(12*(-((-d_x_d_v_db__)/2))))/(12*(1-(1-x)/2))^2;
        d_A_d_v_gb__ = (d_pow_vapp_d_arg1__(1-x, 2)*(-d_x_d_v_gb__))/(12*(1-(1-x)/2))-(pow_vapp(1-x, 2)*(12*(-((-d_x_d_v_gb__)/2))))/(12*(1-(1-x)/2))^2;
        d_A_d_v_sb__ = (d_pow_vapp_d_arg1__(1-x, 2)*(-d_x_d_v_sb__))/(12*(1-(1-x)/2))-(pow_vapp(1-x, 2)*(12*(-((-d_x_d_v_sb__)/2))))/(12*(1-(1-x)/2))^2;
        d_A_d_v_disi__ = (d_pow_vapp_d_arg1__(1-x, 2)*(-d_x_d_v_disi__))/(12*(1-(1-x)/2))-(pow_vapp(1-x, 2)*(12*(-((-d_x_d_v_disi__)/2))))/(12*(1-(1-x)/2))^2;
        d_A_d_v_bsi__ = (d_pow_vapp_d_arg1__(1-x, 2)*(-d_x_d_v_bsi__))/(12*(1-(1-x)/2))-(pow_vapp(1-x, 2)*(12*(-((-d_x_d_v_bsi__)/2))))/(12*(1-(1-x)/2))^2;
    A = pow_vapp(1-x, 2)/(12*(1-(1-x)/2));
        d_B_d_v_db__ = (-(2*(-d_x_d_v_db__)))/(10-(1-x)/2)-((5-2*(1-x))*(-((-d_x_d_v_db__)/2)))/(10-(1-x)/2)^2;
        d_B_d_v_gb__ = (-(2*(-d_x_d_v_gb__)))/(10-(1-x)/2)-((5-2*(1-x))*(-((-d_x_d_v_gb__)/2)))/(10-(1-x)/2)^2;
        d_B_d_v_sb__ = (-(2*(-d_x_d_v_sb__)))/(10-(1-x)/2)-((5-2*(1-x))*(-((-d_x_d_v_sb__)/2)))/(10-(1-x)/2)^2;
        d_B_d_v_disi__ = (-(2*(-d_x_d_v_disi__)))/(10-(1-x)/2)-((5-2*(1-x))*(-((-d_x_d_v_disi__)/2)))/(10-(1-x)/2)^2;
        d_B_d_v_bsi__ = (-(2*(-d_x_d_v_bsi__)))/(10-(1-x)/2)-((5-2*(1-x))*(-((-d_x_d_v_bsi__)/2)))/(10-(1-x)/2)^2;
    B = (5-2*(1-x))/(10-(1-x)/2);
        d_qsc_d_v_db__ = Qinv*((-((-d_x_d_v_db__)/6))+(A*(-d_B_d_v_db__)+d_A_d_v_db__*(1-B)))+d_Qinv_d_v_db__*((0.5-(1-x)/6)+A*(1-B));
        d_qsc_d_v_gb__ = Qinv*((-((-d_x_d_v_gb__)/6))+(A*(-d_B_d_v_gb__)+d_A_d_v_gb__*(1-B)))+d_Qinv_d_v_gb__*((0.5-(1-x)/6)+A*(1-B));
        d_qsc_d_v_sb__ = Qinv*((-((-d_x_d_v_sb__)/6))+(A*(-d_B_d_v_sb__)+d_A_d_v_sb__*(1-B)))+d_Qinv_d_v_sb__*((0.5-(1-x)/6)+A*(1-B));
        d_qsc_d_v_disi__ = Qinv*((-((-d_x_d_v_disi__)/6))+(A*(-d_B_d_v_disi__)+d_A_d_v_disi__*(1-B)))+d_Qinv_d_v_disi__*((0.5-(1-x)/6)+A*(1-B));
        d_qsc_d_v_bsi__ = Qinv*((-((-d_x_d_v_bsi__)/6))+(A*(-d_B_d_v_bsi__)+d_A_d_v_bsi__*(1-B)))+d_Qinv_d_v_bsi__*((0.5-(1-x)/6)+A*(1-B));
    qsc = Qinv*((0.5-(1-x)/6)+A*(1-B));
        d_qdc_d_v_db__ = Qinv*((-((-d_x_d_v_db__)/3))+(A*d_B_d_v_db__+d_A_d_v_db__*B))+d_Qinv_d_v_db__*((0.5-(1-x)/3)+A*B);
        d_qdc_d_v_gb__ = Qinv*((-((-d_x_d_v_gb__)/3))+(A*d_B_d_v_gb__+d_A_d_v_gb__*B))+d_Qinv_d_v_gb__*((0.5-(1-x)/3)+A*B);
        d_qdc_d_v_sb__ = Qinv*((-((-d_x_d_v_sb__)/3))+(A*d_B_d_v_sb__+d_A_d_v_sb__*B))+d_Qinv_d_v_sb__*((0.5-(1-x)/3)+A*B);
        d_qdc_d_v_disi__ = Qinv*((-((-d_x_d_v_disi__)/3))+(A*d_B_d_v_disi__+d_A_d_v_disi__*B))+d_Qinv_d_v_disi__*((0.5-(1-x)/3)+A*B);
        d_qdc_d_v_bsi__ = Qinv*((-((-d_x_d_v_bsi__)/3))+(A*d_B_d_v_bsi__+d_A_d_v_bsi__*B))+d_Qinv_d_v_bsi__*((0.5-(1-x)/3)+A*B);
    qdc = Qinv*((0.5-(1-x)/3)+A*B);
        d_qi_d_v_db__ = d_qsc_d_v_db__+d_qdc_d_v_db__;
        d_qi_d_v_gb__ = d_qsc_d_v_gb__+d_qdc_d_v_gb__;
        d_qi_d_v_sb__ = d_qsc_d_v_sb__+d_qdc_d_v_sb__;
        d_qi_d_v_disi__ = d_qsc_d_v_disi__+d_qdc_d_v_disi__;
        d_qi_d_v_bsi__ = d_qsc_d_v_bsi__+d_qdc_d_v_bsi__;
    qi = qsc+qdc;
    tol = ((((1e-10*parm_vxo)/100)*((1e-10*parm_vxo)/100))*me)/(2*1.6022e-19);
    if Vdsi<=tol
            d_kq2_d_v_gb__ = (((((2*1.6022e-19)/me)*d_Vdsi_d_v_gb__)*parm_zeta)/(vx0*vx0))*10000;
            d_kq2_d_v_disi__ = (((((2*1.6022e-19)/me)*d_Vdsi_d_v_disi__)*parm_zeta)/(vx0*vx0))*10000;
            d_kq2_d_v_bsi__ = (((((2*1.6022e-19)/me)*d_Vdsi_d_v_bsi__)*parm_zeta)/(vx0*vx0))*10000;
        kq2 = (((((2*1.6022e-19)/me)*Vdsi)*parm_zeta)/(vx0*vx0))*10000;
            d_kq4_d_v_gb__ = kq2*d_kq2_d_v_gb__+d_kq2_d_v_gb__*kq2;
            d_kq4_d_v_disi__ = kq2*d_kq2_d_v_disi__+d_kq2_d_v_disi__*kq2;
            d_kq4_d_v_bsi__ = kq2*d_kq2_d_v_bsi__+d_kq2_d_v_bsi__*kq2;
        kq4 = kq2*kq2;
            d_qsb_d_v_db__ = d_Qinv_d_v_db__*((0.5-kq2/12)+kq4/32);
            d_qsb_d_v_gb__ = Qinv*((-(d_kq2_d_v_gb__/12))+(d_kq4_d_v_gb__/32))+d_Qinv_d_v_gb__*((0.5-kq2/12)+kq4/32);
            d_qsb_d_v_sb__ = d_Qinv_d_v_sb__*((0.5-kq2/12)+kq4/32);
            d_qsb_d_v_disi__ = Qinv*((-(d_kq2_d_v_disi__/12))+(d_kq4_d_v_disi__/32))+d_Qinv_d_v_disi__*((0.5-kq2/12)+kq4/32);
            d_qsb_d_v_bsi__ = Qinv*((-(d_kq2_d_v_bsi__/12))+(d_kq4_d_v_bsi__/32))+d_Qinv_d_v_bsi__*((0.5-kq2/12)+kq4/32);
        qsb = Qinv*((0.5-kq2/12)+kq4/32);
            d_qdb_d_v_db__ = d_Qinv_d_v_db__*((0.5-kq2/6)+(3*kq4)/32);
            d_qdb_d_v_gb__ = Qinv*((-(d_kq2_d_v_gb__/6))+((3*d_kq4_d_v_gb__)/32))+d_Qinv_d_v_gb__*((0.5-kq2/6)+(3*kq4)/32);
            d_qdb_d_v_sb__ = d_Qinv_d_v_sb__*((0.5-kq2/6)+(3*kq4)/32);
            d_qdb_d_v_disi__ = Qinv*((-(d_kq2_d_v_disi__/6))+((3*d_kq4_d_v_disi__)/32))+d_Qinv_d_v_disi__*((0.5-kq2/6)+(3*kq4)/32);
            d_qdb_d_v_bsi__ = Qinv*((-(d_kq2_d_v_bsi__/6))+((3*d_kq4_d_v_bsi__)/32))+d_Qinv_d_v_bsi__*((0.5-kq2/6)+(3*kq4)/32);
        qdb = Qinv*((0.5-kq2/6)+(3*kq4)/32);
    else
            d_kq_d_v_gb__ = (((1/(2*sqrt((((2*1.6022e-19)/me)*Vdsi)*parm_zeta)))*((((2*1.6022e-19)/me)*d_Vdsi_d_v_gb__)*parm_zeta))/vx0)*100;
            d_kq_d_v_disi__ = (((1/(2*sqrt((((2*1.6022e-19)/me)*Vdsi)*parm_zeta)))*((((2*1.6022e-19)/me)*d_Vdsi_d_v_disi__)*parm_zeta))/vx0)*100;
            d_kq_d_v_bsi__ = (((1/(2*sqrt((((2*1.6022e-19)/me)*Vdsi)*parm_zeta)))*((((2*1.6022e-19)/me)*d_Vdsi_d_v_bsi__)*parm_zeta))/vx0)*100;
        kq = (sqrt((((2*1.6022e-19)/me)*Vdsi)*parm_zeta)/vx0)*100;
            d_kq2_d_v_gb__ = kq*d_kq_d_v_gb__+d_kq_d_v_gb__*kq;
            d_kq2_d_v_disi__ = kq*d_kq_d_v_disi__+d_kq_d_v_disi__*kq;
            d_kq2_d_v_bsi__ = kq*d_kq_d_v_bsi__+d_kq_d_v_bsi__*kq;
        kq2 = kq*kq;
            d_qsb_d_v_db__ = (d_Qinv_d_v_db__*((4*(kq2+1))*sqrt(kq2+1)-(6*kq2+4)))/((3*kq2)*kq2);
            d_qsb_d_v_gb__ = (Qinv*(((4*(kq2+1))*((1/(2*sqrt(kq2+1)))*(d_kq2_d_v_gb__))+(4*(d_kq2_d_v_gb__))*sqrt(kq2+1))-((6*d_kq2_d_v_gb__)))+d_Qinv_d_v_gb__*((4*(kq2+1))*sqrt(kq2+1)-(6*kq2+4)))/((3*kq2)*kq2)-((Qinv*((4*(kq2+1))*sqrt(kq2+1)-(6*kq2+4)))*((3*kq2)*d_kq2_d_v_gb__+(3*d_kq2_d_v_gb__)*kq2))/((3*kq2)*kq2)^2;
            d_qsb_d_v_sb__ = (d_Qinv_d_v_sb__*((4*(kq2+1))*sqrt(kq2+1)-(6*kq2+4)))/((3*kq2)*kq2);
            d_qsb_d_v_disi__ = (Qinv*(((4*(kq2+1))*((1/(2*sqrt(kq2+1)))*(d_kq2_d_v_disi__))+(4*(d_kq2_d_v_disi__))*sqrt(kq2+1))-((6*d_kq2_d_v_disi__)))+d_Qinv_d_v_disi__*((4*(kq2+1))*sqrt(kq2+1)-(6*kq2+4)))/((3*kq2)*kq2)-((Qinv*((4*(kq2+1))*sqrt(kq2+1)-(6*kq2+4)))*((3*kq2)*d_kq2_d_v_disi__+(3*d_kq2_d_v_disi__)*kq2))/((3*kq2)*kq2)^2;
            d_qsb_d_v_bsi__ = (Qinv*(((4*(kq2+1))*((1/(2*sqrt(kq2+1)))*(d_kq2_d_v_bsi__))+(4*(d_kq2_d_v_bsi__))*sqrt(kq2+1))-((6*d_kq2_d_v_bsi__)))+d_Qinv_d_v_bsi__*((4*(kq2+1))*sqrt(kq2+1)-(6*kq2+4)))/((3*kq2)*kq2)-((Qinv*((4*(kq2+1))*sqrt(kq2+1)-(6*kq2+4)))*((3*kq2)*d_kq2_d_v_bsi__+(3*d_kq2_d_v_bsi__)*kq2))/((3*kq2)*kq2)^2;
        qsb = (Qinv*((4*(kq2+1))*sqrt(kq2+1)-(6*kq2+4)))/((3*kq2)*kq2);
            d_qdb_d_v_db__ = (d_Qinv_d_v_db__*((2*(kq2-2))*sqrt(kq2+1)+4))/((3*kq2)*kq2);
            d_qdb_d_v_gb__ = (Qinv*(((2*(kq2-2))*((1/(2*sqrt(kq2+1)))*(d_kq2_d_v_gb__))+(2*(d_kq2_d_v_gb__))*sqrt(kq2+1)))+d_Qinv_d_v_gb__*((2*(kq2-2))*sqrt(kq2+1)+4))/((3*kq2)*kq2)-((Qinv*((2*(kq2-2))*sqrt(kq2+1)+4))*((3*kq2)*d_kq2_d_v_gb__+(3*d_kq2_d_v_gb__)*kq2))/((3*kq2)*kq2)^2;
            d_qdb_d_v_sb__ = (d_Qinv_d_v_sb__*((2*(kq2-2))*sqrt(kq2+1)+4))/((3*kq2)*kq2);
            d_qdb_d_v_disi__ = (Qinv*(((2*(kq2-2))*((1/(2*sqrt(kq2+1)))*(d_kq2_d_v_disi__))+(2*(d_kq2_d_v_disi__))*sqrt(kq2+1)))+d_Qinv_d_v_disi__*((2*(kq2-2))*sqrt(kq2+1)+4))/((3*kq2)*kq2)-((Qinv*((2*(kq2-2))*sqrt(kq2+1)+4))*((3*kq2)*d_kq2_d_v_disi__+(3*d_kq2_d_v_disi__)*kq2))/((3*kq2)*kq2)^2;
            d_qdb_d_v_bsi__ = (Qinv*(((2*(kq2-2))*((1/(2*sqrt(kq2+1)))*(d_kq2_d_v_bsi__))+(2*(d_kq2_d_v_bsi__))*sqrt(kq2+1)))+d_Qinv_d_v_bsi__*((2*(kq2-2))*sqrt(kq2+1)+4))/((3*kq2)*kq2)-((Qinv*((2*(kq2-2))*sqrt(kq2+1)+4))*((3*kq2)*d_kq2_d_v_bsi__+(3*d_kq2_d_v_bsi__)*kq2))/((3*kq2)*kq2)^2;
        qdb = (Qinv*((2*(kq2-2))*sqrt(kq2+1)+4))/((3*kq2)*kq2);
    end
    if parm_CTM_select==1
            d_qs_d_v_db__ = d_qsc_d_v_db__;
            d_qs_d_v_gb__ = d_qsc_d_v_gb__;
            d_qs_d_v_sb__ = d_qsc_d_v_sb__;
            d_qs_d_v_disi__ = d_qsc_d_v_disi__;
            d_qs_d_v_bsi__ = d_qsc_d_v_bsi__;
        qs = qsc;
            d_qd_d_v_db__ = d_qdc_d_v_db__;
            d_qd_d_v_gb__ = d_qdc_d_v_gb__;
            d_qd_d_v_sb__ = d_qdc_d_v_sb__;
            d_qd_d_v_disi__ = d_qdc_d_v_disi__;
            d_qd_d_v_bsi__ = d_qdc_d_v_bsi__;
        qd = qdc;
    else
            d_qs_d_v_db__ = (qsc*(-(Fsatq*d_Fsatq_d_v_db__+d_Fsatq_d_v_db__*Fsatq))+d_qsc_d_v_db__*(1-Fsatq*Fsatq))+((qsb*Fsatq)*d_Fsatq_d_v_db__+(qsb*d_Fsatq_d_v_db__+d_qsb_d_v_db__*Fsatq)*Fsatq);
            d_qs_d_v_gb__ = (qsc*(-(Fsatq*d_Fsatq_d_v_gb__+d_Fsatq_d_v_gb__*Fsatq))+d_qsc_d_v_gb__*(1-Fsatq*Fsatq))+((qsb*Fsatq)*d_Fsatq_d_v_gb__+(qsb*d_Fsatq_d_v_gb__+d_qsb_d_v_gb__*Fsatq)*Fsatq);
            d_qs_d_v_sb__ = (qsc*(-(Fsatq*d_Fsatq_d_v_sb__+d_Fsatq_d_v_sb__*Fsatq))+d_qsc_d_v_sb__*(1-Fsatq*Fsatq))+((qsb*Fsatq)*d_Fsatq_d_v_sb__+(qsb*d_Fsatq_d_v_sb__+d_qsb_d_v_sb__*Fsatq)*Fsatq);
            d_qs_d_v_disi__ = (qsc*(-(Fsatq*d_Fsatq_d_v_disi__+d_Fsatq_d_v_disi__*Fsatq))+d_qsc_d_v_disi__*(1-Fsatq*Fsatq))+((qsb*Fsatq)*d_Fsatq_d_v_disi__+(qsb*d_Fsatq_d_v_disi__+d_qsb_d_v_disi__*Fsatq)*Fsatq);
            d_qs_d_v_bsi__ = (qsc*(-(Fsatq*d_Fsatq_d_v_bsi__+d_Fsatq_d_v_bsi__*Fsatq))+d_qsc_d_v_bsi__*(1-Fsatq*Fsatq))+((qsb*Fsatq)*d_Fsatq_d_v_bsi__+(qsb*d_Fsatq_d_v_bsi__+d_qsb_d_v_bsi__*Fsatq)*Fsatq);
        qs = qsc*(1-Fsatq*Fsatq)+(qsb*Fsatq)*Fsatq;
            d_qd_d_v_db__ = (qdc*(-(Fsatq*d_Fsatq_d_v_db__+d_Fsatq_d_v_db__*Fsatq))+d_qdc_d_v_db__*(1-Fsatq*Fsatq))+((qdb*Fsatq)*d_Fsatq_d_v_db__+(qdb*d_Fsatq_d_v_db__+d_qdb_d_v_db__*Fsatq)*Fsatq);
            d_qd_d_v_gb__ = (qdc*(-(Fsatq*d_Fsatq_d_v_gb__+d_Fsatq_d_v_gb__*Fsatq))+d_qdc_d_v_gb__*(1-Fsatq*Fsatq))+((qdb*Fsatq)*d_Fsatq_d_v_gb__+(qdb*d_Fsatq_d_v_gb__+d_qdb_d_v_gb__*Fsatq)*Fsatq);
            d_qd_d_v_sb__ = (qdc*(-(Fsatq*d_Fsatq_d_v_sb__+d_Fsatq_d_v_sb__*Fsatq))+d_qdc_d_v_sb__*(1-Fsatq*Fsatq))+((qdb*Fsatq)*d_Fsatq_d_v_sb__+(qdb*d_Fsatq_d_v_sb__+d_qdb_d_v_sb__*Fsatq)*Fsatq);
            d_qd_d_v_disi__ = (qdc*(-(Fsatq*d_Fsatq_d_v_disi__+d_Fsatq_d_v_disi__*Fsatq))+d_qdc_d_v_disi__*(1-Fsatq*Fsatq))+((qdb*Fsatq)*d_Fsatq_d_v_disi__+(qdb*d_Fsatq_d_v_disi__+d_qdb_d_v_disi__*Fsatq)*Fsatq);
            d_qd_d_v_bsi__ = (qdc*(-(Fsatq*d_Fsatq_d_v_bsi__+d_Fsatq_d_v_bsi__*Fsatq))+d_qdc_d_v_bsi__*(1-Fsatq*Fsatq))+((qdb*Fsatq)*d_Fsatq_d_v_bsi__+(qdb*d_Fsatq_d_v_bsi__+d_qdb_d_v_bsi__*Fsatq)*Fsatq);
        qd = qdc*(1-Fsatq*Fsatq)+(qdb*Fsatq)*Fsatq;
    end
        d_Qb_d_v_db__ = ((-parm_type*parm_W)*Leff)*(((parm_Cg*parm_gamma)*((1/(2*sqrt(abs(psis-Vbsi))))*(sign(psis-Vbsi)*(d_psis_d_v_db__))))+((((a-1)/(1*a))*Qinv)*(-d_qi_d_v_db__)+(((a-1)/(1*a))*d_Qinv_d_v_db__+((d_a_d_v_db__)/(1*a)-((a-1)*(1*d_a_d_v_db__))/(1*a)^2)*Qinv)*(1-qi)));
        d_Qb_d_v_gb__ = ((-parm_type*parm_W)*Leff)*(((parm_Cg*parm_gamma)*((1/(2*sqrt(abs(psis-Vbsi))))*(sign(psis-Vbsi)*(d_psis_d_v_gb__-d_Vbsi_d_v_gb__))))+((((a-1)/(1*a))*Qinv)*(-d_qi_d_v_gb__)+(((a-1)/(1*a))*d_Qinv_d_v_gb__+((d_a_d_v_gb__)/(1*a)-((a-1)*(1*d_a_d_v_gb__))/(1*a)^2)*Qinv)*(1-qi)));
        d_Qb_d_v_sb__ = ((-parm_type*parm_W)*Leff)*(((parm_Cg*parm_gamma)*((1/(2*sqrt(abs(psis-Vbsi))))*(sign(psis-Vbsi)*(d_psis_d_v_sb__))))+((((a-1)/(1*a))*Qinv)*(-d_qi_d_v_sb__)+(((a-1)/(1*a))*d_Qinv_d_v_sb__+((d_a_d_v_sb__)/(1*a)-((a-1)*(1*d_a_d_v_sb__))/(1*a)^2)*Qinv)*(1-qi)));
        d_Qb_d_v_disi__ = ((-parm_type*parm_W)*Leff)*(((parm_Cg*parm_gamma)*((1/(2*sqrt(abs(psis-Vbsi))))*(sign(psis-Vbsi)*(d_psis_d_v_disi__-d_Vbsi_d_v_disi__))))+((((a-1)/(1*a))*Qinv)*(-d_qi_d_v_disi__)+(((a-1)/(1*a))*d_Qinv_d_v_disi__+((d_a_d_v_disi__)/(1*a)-((a-1)*(1*d_a_d_v_disi__))/(1*a)^2)*Qinv)*(1-qi)));
        d_Qb_d_v_bsi__ = ((-parm_type*parm_W)*Leff)*(((parm_Cg*parm_gamma)*((1/(2*sqrt(abs(psis-Vbsi))))*(sign(psis-Vbsi)*(d_psis_d_v_bsi__-d_Vbsi_d_v_bsi__))))+((((a-1)/(1*a))*Qinv)*(-d_qi_d_v_bsi__)+(((a-1)/(1*a))*d_Qinv_d_v_bsi__+((d_a_d_v_bsi__)/(1*a)-((a-1)*(1*d_a_d_v_bsi__))/(1*a)^2)*Qinv)*(1-qi)));
    Qb = ((-parm_type*parm_W)*Leff)*((parm_Cg*parm_gamma)*sqrt(abs(psis-Vbsi))+(((a-1)/(1*a))*Qinv)*(1-qi));
        d_etai_d_v_db__ = (-(-(d_FF_d_v_db__*aphit)))/nphit;
        d_etai_d_v_gb__ = (d_Vgsi_d_v_gb__-(d_Vt0bs0_d_v_gb__-(d_FF_d_v_gb__*aphit)))/nphit-((Vgsi-(Vt0bs0-FF*aphit))*d_nphit_d_v_gb__)/nphit^2;
        d_etai_d_v_sb__ = (-(-(d_FF_d_v_sb__*aphit)))/nphit;
        d_etai_d_v_disi__ = (d_Vgsi_d_v_disi__-(d_Vt0bs0_d_v_disi__-(d_FF_d_v_disi__*aphit)))/nphit-((Vgsi-(Vt0bs0-FF*aphit))*d_nphit_d_v_disi__)/nphit^2;
        d_etai_d_v_bsi__ = (d_Vgsi_d_v_bsi__-(d_Vt0bs0_d_v_bsi__-(d_FF_d_v_bsi__*aphit)))/nphit-((Vgsi-(Vt0bs0-FF*aphit))*d_nphit_d_v_bsi__)/nphit^2;
    etai = (Vgsi-(Vt0bs0-FF*aphit))/nphit;
    if etai<=40
            d_Qinvi_d_v_db__ = Qref*((1/(1+exp(etai)))*(exp(etai)*d_etai_d_v_db__));
            d_Qinvi_d_v_gb__ = Qref*((1/(1+exp(etai)))*(exp(etai)*d_etai_d_v_gb__))+d_Qref_d_v_gb__*log(1+exp(etai));
            d_Qinvi_d_v_sb__ = Qref*((1/(1+exp(etai)))*(exp(etai)*d_etai_d_v_sb__));
            d_Qinvi_d_v_disi__ = Qref*((1/(1+exp(etai)))*(exp(etai)*d_etai_d_v_disi__))+d_Qref_d_v_disi__*log(1+exp(etai));
            d_Qinvi_d_v_bsi__ = Qref*((1/(1+exp(etai)))*(exp(etai)*d_etai_d_v_bsi__))+d_Qref_d_v_bsi__*log(1+exp(etai));
        Qinvi = Qref*log(1+exp(etai));
    else
            d_Qinvi_d_v_db__ = Qref*d_etai_d_v_db__;
            d_Qinvi_d_v_gb__ = Qref*d_etai_d_v_gb__+d_Qref_d_v_gb__*etai;
            d_Qinvi_d_v_sb__ = Qref*d_etai_d_v_sb__;
            d_Qinvi_d_v_disi__ = Qref*d_etai_d_v_disi__+d_Qref_d_v_disi__*etai;
            d_Qinvi_d_v_bsi__ = Qref*d_etai_d_v_bsi__+d_Qref_d_v_bsi__*etai;
        Qinvi = Qref*etai;
    end
        d_dQinv_d_v_db__ = d_Qinv_d_v_db__-d_Qinvi_d_v_db__;
        d_dQinv_d_v_gb__ = d_Qinv_d_v_gb__-d_Qinvi_d_v_gb__;
        d_dQinv_d_v_sb__ = d_Qinv_d_v_sb__-d_Qinvi_d_v_sb__;
        d_dQinv_d_v_disi__ = d_Qinv_d_v_disi__-d_Qinvi_d_v_disi__;
        d_dQinv_d_v_bsi__ = d_Qinv_d_v_bsi__-d_Qinvi_d_v_bsi__;
    dQinv = Qinv-Qinvi;
        d_dibl_corr_d_v_db__ = ((((1-FF0)*(1-Fsatq))*qi)*d_dQinv_d_v_db__+(((1-FF0)*(1-Fsatq))*d_qi_d_v_db__+((1-FF0)*(-d_Fsatq_d_v_db__))*qi)*dQinv)/Qinv-(((((1-FF0)*(1-Fsatq))*qi)*dQinv)*d_Qinv_d_v_db__)/Qinv^2;
        d_dibl_corr_d_v_gb__ = ((((1-FF0)*(1-Fsatq))*qi)*d_dQinv_d_v_gb__+(((1-FF0)*(1-Fsatq))*d_qi_d_v_gb__+((1-FF0)*(-d_Fsatq_d_v_gb__)+(-d_FF0_d_v_gb__)*(1-Fsatq))*qi)*dQinv)/Qinv-(((((1-FF0)*(1-Fsatq))*qi)*dQinv)*d_Qinv_d_v_gb__)/Qinv^2;
        d_dibl_corr_d_v_sb__ = ((((1-FF0)*(1-Fsatq))*qi)*d_dQinv_d_v_sb__+(((1-FF0)*(1-Fsatq))*d_qi_d_v_sb__+((1-FF0)*(-d_Fsatq_d_v_sb__))*qi)*dQinv)/Qinv-(((((1-FF0)*(1-Fsatq))*qi)*dQinv)*d_Qinv_d_v_sb__)/Qinv^2;
        d_dibl_corr_d_v_disi__ = ((((1-FF0)*(1-Fsatq))*qi)*d_dQinv_d_v_disi__+(((1-FF0)*(1-Fsatq))*d_qi_d_v_disi__+((1-FF0)*(-d_Fsatq_d_v_disi__)+(-d_FF0_d_v_disi__)*(1-Fsatq))*qi)*dQinv)/Qinv-(((((1-FF0)*(1-Fsatq))*qi)*dQinv)*d_Qinv_d_v_disi__)/Qinv^2;
        d_dibl_corr_d_v_bsi__ = ((((1-FF0)*(1-Fsatq))*qi)*d_dQinv_d_v_bsi__+(((1-FF0)*(1-Fsatq))*d_qi_d_v_bsi__+((1-FF0)*(-d_Fsatq_d_v_bsi__)+(-d_FF0_d_v_bsi__)*(1-Fsatq))*qi)*dQinv)/Qinv-(((((1-FF0)*(1-Fsatq))*qi)*dQinv)*d_Qinv_d_v_bsi__)/Qinv^2;
    dibl_corr = ((((1-FF0)*(1-Fsatq))*qi)*dQinv)/Qinv;
        d_qd_d_v_db__ = d_qd_d_v_db__-d_dibl_corr_d_v_db__;
        d_qd_d_v_gb__ = d_qd_d_v_gb__-d_dibl_corr_d_v_gb__;
        d_qd_d_v_sb__ = d_qd_d_v_sb__-d_dibl_corr_d_v_sb__;
        d_qd_d_v_disi__ = d_qd_d_v_disi__-d_dibl_corr_d_v_disi__;
        d_qd_d_v_bsi__ = d_qd_d_v_bsi__-d_dibl_corr_d_v_bsi__;
    qd = qd-dibl_corr;
        d_Qinvs_d_v_db__ = ((parm_type*Leff)*(((1+dir)*d_qs_d_v_db__)+((1-dir)*d_qd_d_v_db__)))/2;
        d_Qinvs_d_v_gb__ = ((parm_type*Leff)*(((1+dir)*d_qs_d_v_gb__+(d_dir_d_v_gb__)*qs)+((1-dir)*d_qd_d_v_gb__+(-d_dir_d_v_gb__)*qd)))/2;
        d_Qinvs_d_v_sb__ = ((parm_type*Leff)*(((1+dir)*d_qs_d_v_sb__)+((1-dir)*d_qd_d_v_sb__)))/2;
        d_Qinvs_d_v_disi__ = ((parm_type*Leff)*(((1+dir)*d_qs_d_v_disi__+(d_dir_d_v_disi__)*qs)+((1-dir)*d_qd_d_v_disi__+(-d_dir_d_v_disi__)*qd)))/2;
        d_Qinvs_d_v_bsi__ = ((parm_type*Leff)*(((1+dir)*d_qs_d_v_bsi__+(d_dir_d_v_bsi__)*qs)+((1-dir)*d_qd_d_v_bsi__+(-d_dir_d_v_bsi__)*qd)))/2;
    Qinvs = ((parm_type*Leff)*((1+dir)*qs+(1-dir)*qd))/2;
        d_Qinvd_d_v_db__ = ((parm_type*Leff)*(((1-dir)*d_qs_d_v_db__)+((1+dir)*d_qd_d_v_db__)))/2;
        d_Qinvd_d_v_gb__ = ((parm_type*Leff)*(((1-dir)*d_qs_d_v_gb__+(-d_dir_d_v_gb__)*qs)+((1+dir)*d_qd_d_v_gb__+(d_dir_d_v_gb__)*qd)))/2;
        d_Qinvd_d_v_sb__ = ((parm_type*Leff)*(((1-dir)*d_qs_d_v_sb__)+((1+dir)*d_qd_d_v_sb__)))/2;
        d_Qinvd_d_v_disi__ = ((parm_type*Leff)*(((1-dir)*d_qs_d_v_disi__+(-d_dir_d_v_disi__)*qs)+((1+dir)*d_qd_d_v_disi__+(d_dir_d_v_disi__)*qd)))/2;
        d_Qinvd_d_v_bsi__ = ((parm_type*Leff)*(((1-dir)*d_qs_d_v_bsi__+(-d_dir_d_v_bsi__)*qs)+((1+dir)*d_qd_d_v_bsi__+(d_dir_d_v_bsi__)*qd)))/2;
    Qinvd = ((parm_type*Leff)*((1-dir)*qs+(1+dir)*qd))/2;
        d_Qsov_d_v_gb__ = Cofs*d_v_gsi_d_v_gb__;
        d_Qsov_d_v_bsi__ = Cofs*d_v_gsi_d_v_bsi__;
    Qsov = Cofs*v_gsi__;
        d_Qdov_d_v_gb__ = Cofd*d_v_gdi_d_v_gb__;
        d_Qdov_d_v_disi__ = Cofd*d_v_gdi_d_v_disi__;
        d_Qdov_d_v_bsi__ = Cofd*d_v_gdi_d_v_bsi__;
    Qdov = Cofd*v_gdi__;
        d_Vt0x_d_v_bsi__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-parm_type*v_bsi__))))*(sign(parm_phib-parm_type*v_bsi__)*(-(parm_type*1)))));
    Vt0x = parm_Vt0+parm_gamma*(sqrt(abs(parm_phib-parm_type*v_bsi__))-sqrt(parm_phib));
        d_Vt0y_d_v_disi__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-parm_type*v_bdi__))))*(sign(parm_phib-parm_type*v_bdi__)*(-(parm_type*d_v_bdi_d_v_disi__)))));
        d_Vt0y_d_v_bsi__ = (parm_gamma*((1/(2*sqrt(abs(parm_phib-parm_type*v_bdi__))))*(sign(parm_phib-parm_type*v_bdi__)*(-(parm_type*d_v_bdi_d_v_bsi__)))));
    Vt0y = parm_Vt0+parm_gamma*(sqrt(abs(parm_phib-parm_type*v_bdi__))-sqrt(parm_phib));
        d_Fs_arg_d_v_db__ = ((-(-((Vdsi*parm_delta)*d_Fsat_d_v_db__))))/(1.1*nphit);
        d_Fs_arg_d_v_gb__ = ((d_Vgsraw_d_v_gb__-(-((Vdsi*parm_delta)*d_Fsat_d_v_gb__+(d_Vdsi_d_v_gb__*parm_delta)*Fsat))))/(1.1*nphit)-(((Vgsraw-(Vt0x-(Vdsi*parm_delta)*Fsat))+aphit*0.5)*(1.1*d_nphit_d_v_gb__))/(1.1*nphit)^2;
        d_Fs_arg_d_v_sb__ = ((-(-((Vdsi*parm_delta)*d_Fsat_d_v_sb__))))/(1.1*nphit);
        d_Fs_arg_d_v_disi__ = ((-(-((Vdsi*parm_delta)*d_Fsat_d_v_disi__+(d_Vdsi_d_v_disi__*parm_delta)*Fsat))))/(1.1*nphit)-(((Vgsraw-(Vt0x-(Vdsi*parm_delta)*Fsat))+aphit*0.5)*(1.1*d_nphit_d_v_disi__))/(1.1*nphit)^2;
        d_Fs_arg_d_v_bsi__ = ((d_Vgsraw_d_v_bsi__-(d_Vt0x_d_v_bsi__-((Vdsi*parm_delta)*d_Fsat_d_v_bsi__+(d_Vdsi_d_v_bsi__*parm_delta)*Fsat))))/(1.1*nphit)-(((Vgsraw-(Vt0x-(Vdsi*parm_delta)*Fsat))+aphit*0.5)*(1.1*d_nphit_d_v_bsi__))/(1.1*nphit)^2;
    Fs_arg = ((Vgsraw-(Vt0x-(Vdsi*parm_delta)*Fsat))+aphit*0.5)/(1.1*nphit);
    if Fs_arg<=40
            d_Fs_d_v_db__ = exp(Fs_arg)*d_Fs_arg_d_v_db__;
            d_Fs_d_v_gb__ = exp(Fs_arg)*d_Fs_arg_d_v_gb__;
            d_Fs_d_v_sb__ = exp(Fs_arg)*d_Fs_arg_d_v_sb__;
            d_Fs_d_v_disi__ = exp(Fs_arg)*d_Fs_arg_d_v_disi__;
            d_Fs_d_v_bsi__ = exp(Fs_arg)*d_Fs_arg_d_v_bsi__;
        Fs = 1+exp(Fs_arg);
            d_FFx_d_v_db__ = -(nphit*((1/Fs)*d_Fs_d_v_db__));
            d_FFx_d_v_gb__ = d_Vgsraw_d_v_gb__-(nphit*((1/Fs)*d_Fs_d_v_gb__)+d_nphit_d_v_gb__*log(Fs));
            d_FFx_d_v_sb__ = -(nphit*((1/Fs)*d_Fs_d_v_sb__));
            d_FFx_d_v_disi__ = -(nphit*((1/Fs)*d_Fs_d_v_disi__)+d_nphit_d_v_disi__*log(Fs));
            d_FFx_d_v_bsi__ = d_Vgsraw_d_v_bsi__-(nphit*((1/Fs)*d_Fs_d_v_bsi__)+d_nphit_d_v_bsi__*log(Fs));
        FFx = Vgsraw-nphit*log(Fs);
    else
            d_Fs_d_v_db__ = 0;
            d_Fs_d_v_gb__ = 0;
            d_Fs_d_v_sb__ = 0;
            d_Fs_d_v_disi__ = 0;
            d_Fs_d_v_bsi__ = 0;
        Fs = 0;
            d_FFx_d_v_db__ = -(nphit*d_Fs_arg_d_v_db__);
            d_FFx_d_v_gb__ = d_Vgsraw_d_v_gb__-(nphit*d_Fs_arg_d_v_gb__+d_nphit_d_v_gb__*Fs_arg);
            d_FFx_d_v_sb__ = -(nphit*d_Fs_arg_d_v_sb__);
            d_FFx_d_v_disi__ = -(nphit*d_Fs_arg_d_v_disi__+d_nphit_d_v_disi__*Fs_arg);
            d_FFx_d_v_bsi__ = d_Vgsraw_d_v_bsi__-(nphit*d_Fs_arg_d_v_bsi__+d_nphit_d_v_bsi__*Fs_arg);
        FFx = Vgsraw-nphit*Fs_arg;
    end
        d_Fd_arg_d_v_db__ = ((-(-((Vdsi*parm_delta)*d_Fsat_d_v_db__))))/(1.1*nphit);
        d_Fd_arg_d_v_gb__ = ((d_Vgdraw_d_v_gb__-(-((Vdsi*parm_delta)*d_Fsat_d_v_gb__+(d_Vdsi_d_v_gb__*parm_delta)*Fsat))))/(1.1*nphit)-(((Vgdraw-(Vt0y-(Vdsi*parm_delta)*Fsat))+aphit*0.5)*(1.1*d_nphit_d_v_gb__))/(1.1*nphit)^2;
        d_Fd_arg_d_v_sb__ = ((-(-((Vdsi*parm_delta)*d_Fsat_d_v_sb__))))/(1.1*nphit);
        d_Fd_arg_d_v_disi__ = ((d_Vgdraw_d_v_disi__-(d_Vt0y_d_v_disi__-((Vdsi*parm_delta)*d_Fsat_d_v_disi__+(d_Vdsi_d_v_disi__*parm_delta)*Fsat))))/(1.1*nphit)-(((Vgdraw-(Vt0y-(Vdsi*parm_delta)*Fsat))+aphit*0.5)*(1.1*d_nphit_d_v_disi__))/(1.1*nphit)^2;
        d_Fd_arg_d_v_bsi__ = ((d_Vgdraw_d_v_bsi__-(d_Vt0y_d_v_bsi__-((Vdsi*parm_delta)*d_Fsat_d_v_bsi__+(d_Vdsi_d_v_bsi__*parm_delta)*Fsat))))/(1.1*nphit)-(((Vgdraw-(Vt0y-(Vdsi*parm_delta)*Fsat))+aphit*0.5)*(1.1*d_nphit_d_v_bsi__))/(1.1*nphit)^2;
    Fd_arg = ((Vgdraw-(Vt0y-(Vdsi*parm_delta)*Fsat))+aphit*0.5)/(1.1*nphit);
    if Fd_arg<=40
            d_Fd_d_v_db__ = exp(Fd_arg)*d_Fd_arg_d_v_db__;
            d_Fd_d_v_gb__ = exp(Fd_arg)*d_Fd_arg_d_v_gb__;
            d_Fd_d_v_sb__ = exp(Fd_arg)*d_Fd_arg_d_v_sb__;
            d_Fd_d_v_disi__ = exp(Fd_arg)*d_Fd_arg_d_v_disi__;
            d_Fd_d_v_bsi__ = exp(Fd_arg)*d_Fd_arg_d_v_bsi__;
        Fd = 1+exp(Fd_arg);
            d_FFy_d_v_db__ = -(nphit*((1/Fd)*d_Fd_d_v_db__));
            d_FFy_d_v_gb__ = d_Vgdraw_d_v_gb__-(nphit*((1/Fd)*d_Fd_d_v_gb__)+d_nphit_d_v_gb__*log(Fd));
            d_FFy_d_v_sb__ = -(nphit*((1/Fd)*d_Fd_d_v_sb__));
            d_FFy_d_v_disi__ = d_Vgdraw_d_v_disi__-(nphit*((1/Fd)*d_Fd_d_v_disi__)+d_nphit_d_v_disi__*log(Fd));
            d_FFy_d_v_bsi__ = d_Vgdraw_d_v_bsi__-(nphit*((1/Fd)*d_Fd_d_v_bsi__)+d_nphit_d_v_bsi__*log(Fd));
        FFy = Vgdraw-nphit*log(Fd);
    else
            d_Fd_d_v_db__ = 0;
            d_Fd_d_v_gb__ = 0;
            d_Fd_d_v_sb__ = 0;
            d_Fd_d_v_disi__ = 0;
            d_Fd_d_v_bsi__ = 0;
        Fd = 0;
            d_FFy_d_v_db__ = -(nphit*d_Fd_arg_d_v_db__);
            d_FFy_d_v_gb__ = d_Vgdraw_d_v_gb__-(nphit*d_Fd_arg_d_v_gb__+d_nphit_d_v_gb__*Fd_arg);
            d_FFy_d_v_sb__ = -(nphit*d_Fd_arg_d_v_sb__);
            d_FFy_d_v_disi__ = d_Vgdraw_d_v_disi__-(nphit*d_Fd_arg_d_v_disi__+d_nphit_d_v_disi__*Fd_arg);
            d_FFy_d_v_bsi__ = d_Vgdraw_d_v_bsi__-(nphit*d_Fd_arg_d_v_bsi__+d_nphit_d_v_bsi__*Fd_arg);
        FFy = Vgdraw-nphit*Fd_arg;
    end
        d_Qsif_d_v_db__ = (parm_type*parm_Cif+parm_CC*Vgsraw)*d_FFx_d_v_db__;
        d_Qsif_d_v_gb__ = (parm_type*parm_Cif+parm_CC*Vgsraw)*d_FFx_d_v_gb__+((parm_CC*d_Vgsraw_d_v_gb__))*FFx;
        d_Qsif_d_v_sb__ = (parm_type*parm_Cif+parm_CC*Vgsraw)*d_FFx_d_v_sb__;
        d_Qsif_d_v_disi__ = (parm_type*parm_Cif+parm_CC*Vgsraw)*d_FFx_d_v_disi__;
        d_Qsif_d_v_bsi__ = (parm_type*parm_Cif+parm_CC*Vgsraw)*d_FFx_d_v_bsi__+((parm_CC*d_Vgsraw_d_v_bsi__))*FFx;
    Qsif = (parm_type*parm_Cif+parm_CC*Vgsraw)*FFx;
        d_Qdif_d_v_db__ = (parm_type*parm_Cif+parm_CC*Vgdraw)*d_FFy_d_v_db__;
        d_Qdif_d_v_gb__ = (parm_type*parm_Cif+parm_CC*Vgdraw)*d_FFy_d_v_gb__+((parm_CC*d_Vgdraw_d_v_gb__))*FFy;
        d_Qdif_d_v_sb__ = (parm_type*parm_Cif+parm_CC*Vgdraw)*d_FFy_d_v_sb__;
        d_Qdif_d_v_disi__ = (parm_type*parm_Cif+parm_CC*Vgdraw)*d_FFy_d_v_disi__+((parm_CC*d_Vgdraw_d_v_disi__))*FFy;
        d_Qdif_d_v_bsi__ = (parm_type*parm_Cif+parm_CC*Vgdraw)*d_FFy_d_v_bsi__+((parm_CC*d_Vgdraw_d_v_bsi__))*FFy;
    Qdif = (parm_type*parm_Cif+parm_CC*Vgdraw)*FFy;
        d_Qs_d_v_db__ = -parm_W*((d_Qinvs_d_v_db__)+d_Qsif_d_v_db__);
        d_Qs_d_v_gb__ = -parm_W*((d_Qinvs_d_v_gb__+d_Qsov_d_v_gb__)+d_Qsif_d_v_gb__);
        d_Qs_d_v_sb__ = -parm_W*((d_Qinvs_d_v_sb__)+d_Qsif_d_v_sb__);
        d_Qs_d_v_disi__ = -parm_W*((d_Qinvs_d_v_disi__)+d_Qsif_d_v_disi__);
        d_Qs_d_v_bsi__ = -parm_W*((d_Qinvs_d_v_bsi__+d_Qsov_d_v_bsi__)+d_Qsif_d_v_bsi__);
    Qs = -parm_W*((Qinvs+Qsov)+Qsif);
        d_Qd_d_v_db__ = -parm_W*((d_Qinvd_d_v_db__)+d_Qdif_d_v_db__);
        d_Qd_d_v_gb__ = -parm_W*((d_Qinvd_d_v_gb__+d_Qdov_d_v_gb__)+d_Qdif_d_v_gb__);
        d_Qd_d_v_sb__ = -parm_W*((d_Qinvd_d_v_sb__)+d_Qdif_d_v_sb__);
        d_Qd_d_v_disi__ = -parm_W*((d_Qinvd_d_v_disi__+d_Qdov_d_v_disi__)+d_Qdif_d_v_disi__);
        d_Qd_d_v_bsi__ = -parm_W*((d_Qinvd_d_v_bsi__+d_Qdov_d_v_bsi__)+d_Qdif_d_v_bsi__);
    Qd = -parm_W*((Qinvd+Qdov)+Qdif);
        d_Qg_d_v_db__ = -((d_Qs_d_v_db__+d_Qd_d_v_db__)+d_Qb_d_v_db__);
        d_Qg_d_v_gb__ = -((d_Qs_d_v_gb__+d_Qd_d_v_gb__)+d_Qb_d_v_gb__);
        d_Qg_d_v_sb__ = -((d_Qs_d_v_sb__+d_Qd_d_v_sb__)+d_Qb_d_v_sb__);
        d_Qg_d_v_disi__ = -((d_Qs_d_v_disi__+d_Qd_d_v_disi__)+d_Qb_d_v_disi__);
        d_Qg_d_v_bsi__ = -((d_Qs_d_v_bsi__+d_Qd_d_v_bsi__)+d_Qb_d_v_bsi__);
    Qg = -((Qs+Qd)+Qb);
        d_f_i_disi_d_v_db__ = d_f_i_disi_d_v_db__+((parm_type*dir)*d_Id_d_v_db__);
        d_f_i_disi_d_v_gb__ = d_f_i_disi_d_v_gb__+((parm_type*dir)*d_Id_d_v_gb__+(parm_type*d_dir_d_v_gb__)*Id);
        d_f_i_disi_d_v_sb__ = d_f_i_disi_d_v_sb__+((parm_type*dir)*d_Id_d_v_sb__);
        d_f_i_disi_d_v_disi__ = d_f_i_disi_d_v_disi__+((parm_type*dir)*d_Id_d_v_disi__+(parm_type*d_dir_d_v_disi__)*Id);
        d_f_i_disi_d_v_bsi__ = d_f_i_disi_d_v_bsi__+((parm_type*dir)*d_Id_d_v_bsi__+(parm_type*d_dir_d_v_bsi__)*Id);
    % contribution for i_disi;
    f_i_disi__ = f_i_disi__ + (parm_type*dir)*Id;
        d_f_i_ddi_d_v_db__ = d_f_i_ddi_d_v_db__+(d_v_ddi_d_v_db__/Rd);
        d_f_i_ddi_d_v_disi__ = d_f_i_ddi_d_v_disi__+(d_v_ddi_d_v_disi__/Rd);
        d_f_i_ddi_d_v_bsi__ = d_f_i_ddi_d_v_bsi__+(d_v_ddi_d_v_bsi__/Rd);
    % contribution for i_ddi;
    f_i_ddi__ = f_i_ddi__ + v_ddi__/Rd;
        d_f_i_sis_d_v_sb__ = d_f_i_sis_d_v_sb__+(d_v_sis_d_v_sb__/Rs);
        d_f_i_sis_d_v_bsi__ = d_f_i_sis_d_v_bsi__+(d_v_sis_d_v_bsi__/Rs);
    % contribution for i_sis;
    f_i_sis__ = f_i_sis__ + v_sis__/Rs;
        d_q_i_bsi_d_v_db__ = d_q_i_bsi_d_v_db__-d_Qs_d_v_db__;
        d_q_i_bsi_d_v_gb__ = d_q_i_bsi_d_v_gb__-d_Qs_d_v_gb__;
        d_q_i_bsi_d_v_sb__ = d_q_i_bsi_d_v_sb__-d_Qs_d_v_sb__;
        d_q_i_bsi_d_v_disi__ = d_q_i_bsi_d_v_disi__-d_Qs_d_v_disi__;
        d_q_i_bsi_d_v_bsi__ = d_q_i_bsi_d_v_bsi__-d_Qs_d_v_bsi__;
    % contribution for i_bsi;
    q_i_bsi__ = q_i_bsi__ - (Qs);
        d_q_i_bdi_d_v_db__ = d_q_i_bdi_d_v_db__-d_Qd_d_v_db__;
        d_q_i_bdi_d_v_gb__ = d_q_i_bdi_d_v_gb__-d_Qd_d_v_gb__;
        d_q_i_bdi_d_v_sb__ = d_q_i_bdi_d_v_sb__-d_Qd_d_v_sb__;
        d_q_i_bdi_d_v_disi__ = d_q_i_bdi_d_v_disi__-d_Qd_d_v_disi__;
        d_q_i_bdi_d_v_bsi__ = d_q_i_bdi_d_v_bsi__-d_Qd_d_v_bsi__;
    % contribution for i_bdi;
    q_i_bdi__ = q_i_bdi__ - (Qd);
        d_q_i_gb_d_v_db__ = d_q_i_gb_d_v_db__+d_Qg_d_v_db__;
        d_q_i_gb_d_v_gb__ = d_q_i_gb_d_v_gb__+d_Qg_d_v_gb__;
        d_q_i_gb_d_v_sb__ = d_q_i_gb_d_v_sb__+d_Qg_d_v_sb__;
        d_q_i_gb_d_v_disi__ = d_q_i_gb_d_v_disi__+d_Qg_d_v_disi__;
        d_q_i_gb_d_v_bsi__ = d_q_i_gb_d_v_bsi__+d_Qg_d_v_bsi__;
    % contribution for i_gb;
    q_i_gb__ = q_i_gb__ + Qg;
        d_fe_d_X__(1,1) = (d_f_i_ddi_d_v_db__);
        d_qe_d_X__(1,1) = (d_q_i_ddi_d_v_db__);
        d_fe_d_Y__(1,1) = (d_f_i_ddi_d_v_disi__);
        d_qe_d_Y__(1,1) = (d_q_i_ddi_d_v_disi__);
        d_fe_d_Y__(1,2) = (d_f_i_ddi_d_v_bsi__);
        d_qe_d_Y__(1,2) = (d_q_i_ddi_d_v_bsi__);
    % output for terminalFlow_d (explicit out)
    fe__(1) = +f_i_ddi__+i_ds__-i_gd__;
    qe__(1) = +q_i_ddi__;
        d_fe_d_X__(2,1) = --d_f_i_gb_d_v_db__;
        d_qe_d_X__(2,1) = --d_q_i_gb_d_v_db__;
        d_fe_d_X__(2,2) = --d_f_i_gb_d_v_gb__;
        d_qe_d_X__(2,2) = --d_q_i_gb_d_v_gb__;
        d_fe_d_X__(2,3) = --d_f_i_gb_d_v_sb__;
        d_qe_d_X__(2,3) = --d_q_i_gb_d_v_sb__;
        d_fe_d_Y__(2,1) = --d_f_i_gb_d_v_disi__;
        d_qe_d_Y__(2,1) = --d_q_i_gb_d_v_disi__;
        d_fe_d_Y__(2,2) = --d_f_i_gb_d_v_bsi__;
        d_qe_d_Y__(2,2) = --d_q_i_gb_d_v_bsi__;
    % output for terminalFlow_g (explicit out)
    fe__(2) = +i_gs__+i_gd__+i_gsi__+i_gdi__ + f_i_gb__;
    qe__(2) = 0 + q_i_gb__;
        d_fe_d_X__(3,3) = (-d_f_i_sis_d_v_sb__);
        d_qe_d_X__(3,3) = (-d_q_i_sis_d_v_sb__);
        d_fe_d_Y__(3,2) = (-d_f_i_sis_d_v_bsi__);
        d_qe_d_Y__(3,2) = (-d_q_i_sis_d_v_bsi__);
    % output for terminalFlow_s (explicit out)
    fe__(3) = -f_i_sis__-i_ds__-i_gs__;
    qe__(3) = -q_i_sis__;
        d_fi_d_X__(1,1) = ((d_f_i_bdi_d_v_db__+d_f_i_ddi_d_v_db__))-d_f_i_disi_d_v_db__;
        d_qi_d_X__(1,1) = ((d_q_i_bdi_d_v_db__+d_q_i_ddi_d_v_db__))-d_q_i_disi_d_v_db__;
        d_fi_d_X__(1,2) = ((d_f_i_bdi_d_v_gb__))-d_f_i_disi_d_v_gb__;
        d_qi_d_X__(1,2) = ((d_q_i_bdi_d_v_gb__))-d_q_i_disi_d_v_gb__;
        d_fi_d_X__(1,3) = ((d_f_i_bdi_d_v_sb__))-d_f_i_disi_d_v_sb__;
        d_qi_d_X__(1,3) = ((d_q_i_bdi_d_v_sb__))-d_q_i_disi_d_v_sb__;
        d_fi_d_Y__(1,1) = ((d_f_i_bdi_d_v_disi__+d_f_i_ddi_d_v_disi__))-d_f_i_disi_d_v_disi__;
        d_qi_d_Y__(1,1) = ((d_q_i_bdi_d_v_disi__+d_q_i_ddi_d_v_disi__))-d_q_i_disi_d_v_disi__;
        d_fi_d_Y__(1,2) = ((d_f_i_bdi_d_v_bsi__+d_f_i_ddi_d_v_bsi__))-d_f_i_disi_d_v_bsi__;
        d_qi_d_Y__(1,2) = ((d_q_i_bdi_d_v_bsi__+d_q_i_ddi_d_v_bsi__))-d_q_i_disi_d_v_bsi__;
    % output for v_disi (internal unknown)
    fi__(1) = +f_i_bdi__+f_i_ddi__+i_gdi__ - f_i_disi__;
    qi__(1) = +q_i_bdi__+q_i_ddi__ - q_i_disi__;
        d_fi_d_X__(2,1) = ((((-d_f_i_bdi_d_v_db__-d_f_i_ddi_d_v_db__))))-d_f_i_bsi_d_v_db__;
        d_qi_d_X__(2,1) = ((((-d_q_i_bdi_d_v_db__-d_q_i_ddi_d_v_db__))))-d_q_i_bsi_d_v_db__;
        d_fi_d_X__(2,2) = ((((-d_f_i_bdi_d_v_gb__))))-d_f_i_bsi_d_v_gb__;
        d_qi_d_X__(2,2) = ((((-d_q_i_bdi_d_v_gb__))))-d_q_i_bsi_d_v_gb__;
        d_fi_d_X__(2,3) = ((((-d_f_i_bdi_d_v_sb__)+d_f_i_sis_d_v_sb__)))-d_f_i_bsi_d_v_sb__;
        d_qi_d_X__(2,3) = ((((-d_q_i_bdi_d_v_sb__)+d_q_i_sis_d_v_sb__)))-d_q_i_bsi_d_v_sb__;
        d_fi_d_Y__(2,1) = ((((-d_f_i_bdi_d_v_disi__-d_f_i_ddi_d_v_disi__))))-d_f_i_bsi_d_v_disi__;
        d_qi_d_Y__(2,1) = ((((-d_q_i_bdi_d_v_disi__-d_q_i_ddi_d_v_disi__))))-d_q_i_bsi_d_v_disi__;
        d_fi_d_Y__(2,2) = ((((-d_f_i_bdi_d_v_bsi__-d_f_i_ddi_d_v_bsi__)+d_f_i_sis_d_v_bsi__)))-d_f_i_bsi_d_v_bsi__;
        d_qi_d_Y__(2,2) = ((((-d_q_i_bdi_d_v_bsi__-d_q_i_ddi_d_v_bsi__)+d_q_i_sis_d_v_bsi__)))-d_q_i_bsi_d_v_bsi__;
    % output for v_bsi (internal unknown)
    fi__(2) = -f_i_bdi__-f_i_ddi__+f_i_sis__-i_gsi__-i_gdi__ - f_i_bsi__;
    qi__(2) = -q_i_bdi__-q_i_ddi__+q_i_sis__ - q_i_bsi__;
end

function [eonames, iunames, ienames] = get_oui_names__(MOD__)
    eonames = {'idb', 'igb', 'isb'};
    iunames = {'v_disi', 'v_bsi'};
    ienames = {'KCL for i_disi', 'KCL for i_bsi'};
end

function [nFeQe, nFiQi, nOtherIo, nIntUnk] = get_nfq__(MOD__)
    nFeQe = 3;
    nFiQi = 2;
    nOtherIo = 3;
    nIntUnk = 2;
end

function iun = get_iu_names__(MOD)
    [~, iun, ~] = get_oui_names__(MOD);
end

function ien = get_ie_names__(MOD)
    [~, ~, ien] = get_oui_names__(MOD);
end


function d_outVal_d_base__ = d_pow_vapp_d_arg1__(base, exponent)
    d_outVal_d_base__ = 0;
        d_outVal_d_base__ = base^(exponent-1)*(1*exponent);
    outVal = base^exponent;
end

function d_outVal_d_exponent__ = d_pow_vapp_d_arg2__(base, exponent)
    d_outVal_d_exponent__ = 0;
        d_outVal_d_exponent__ = (base^exponent*1)*qmcol_vapp(base>0, log(base), 0);
    outVal = base^exponent;
end

function outVal = pow_vapp(base, exponent)
    outVal = base^exponent;
end
